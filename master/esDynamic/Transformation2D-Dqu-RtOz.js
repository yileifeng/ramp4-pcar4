function Ts(e){switch(e){case 1:return"Unknown error";case 2:return"Corrupted geometry";case 3:return"Empty geometry";case 4:return"Math singularity";case 5:return"Buffer is too small";case 6:return"Invalid shape type";case 7:return"Projection out of supported range";case 8:return"Non simple geometry";case 9:return"Cannot calculate geodesic";case 10:return"Notation conversion";case 11:return"Missing grid file";case 12:return"Invalid call";case 13:return"Internal error";case 14:return"Not implemented";case 15:return"IO error";case 16:return"Invalid 3D";case 17:return"An ambiguous geography edge with antipodal points";case 18:return"Geocentric coordinates require ellipsoidal height";case 19:return"Geography cannot be projected into a gnomonic plane or a result of an operation cannot fit into a gnomonic plane";case 20:return"Geometry is too large to be exported in to a given format";case 22:return"Operation is canceled by the user";case 21:return"The operation, such as projection or geodetic computation, cannot be performed without pe-wasm loaded";default:return"unknown error"}}function _(e,t){try{if(!e)throw new Error(t)}catch(s){throw s}}class Q extends Error{constructor(t,s){super(s),this.m_AdditionalMessage=s,this.m_ErrorType=t,this.name="GeometryError"}what(){return Ts(this.m_ErrorType)}additionalMessage(){return this.m_AdditionalMessage?this.m_AdditionalMessage:""}code(){return this.m_ErrorType}}let Es=class extends Q{constructor(e){super(2,e),this.name="CorruptedGeometryError"}},Is=class extends Q{constructor(e){super(3,e),this.name="EmptyGeometryError"}};class As extends Q{constructor(t){super(4,t),this.name="MathSingularityError"}}let Ds=class extends Q{constructor(e){super(21,e),this.name="ProjectionEngineNotLoadedError"}};class Ps extends Q{constructor(t){super(8,t),this.name="NonSimpleGeometryError"}}var V;(function(e){e[e.enumUnknown=0]="enumUnknown",e[e.enumPoint=513]="enumPoint",e[e.enumLine=5122]="enumLine",e[e.enumBezier=5123]="enumBezier",e[e.enumEllipticArc=5124]="enumEllipticArc",e[e.enumEnvelope=3077]="enumEnvelope",e[e.enumMultiPoint=8710]="enumMultiPoint",e[e.enumPolyline=25607]="enumPolyline",e[e.enumPolygon=27656]="enumPolygon",e[e.enumMultipatch=40969]="enumMultipatch",e[e.enumGeometryCollection=3594]="enumGeometryCollection",e[e.enumRationalBezier2=5134]="enumRationalBezier2",e[e.enumBezier2=5135]="enumBezier2",e[e.enumRationalBezier23d=5392]="enumRationalBezier23d",e[e.enumGreatArc3d=5393]="enumGreatArc3d"})(V||(V={}));const qs=[0,0,1,1,1,2,0,1,2,3,-1,-1,-1,-1,1,1];function zs(e){return qs[15&e]}function Ss(e){return!!(512&e)}function Zs(e){return!!(1024&e)}function Fs(e){return!!(2048&e)}function yt(e){return!!(4096&e)}function $t(e){return!!(8192&e)}function Xt(e){return!!(16384&e)}function Jt(e){return!!(32768&e)}function Ls(e){const t=e.getGeometryType();return $t(t)?e.getPointCount():e.isEmpty()?0:t===V.enumEnvelope?4:t===V.enumPoint?1:yt(t)?2:void Kt("missing type")}function xt(e){const t=e.getGeometryType();if(Xt(t))return e.hasNonLinearSegments();if(t===V.enumGeometryCollection){const s=e;for(let i=0,n=s.getGeometryCount();i<n;i++)if(xt(s.getGeometry(i)))return!0;return!1}return!!yt(t)&&t!==V.enumLine}function Gs(e){throw new Ds(e)}function Bs(e){throw new Es(e)}function W(e){throw new Error(e)}function ft(e){throw new As(e)}function ks(){W("Geometry type is not supported for 3D operations.")}function Os(e){throw new Q(12,e)}function Us(e){throw new Is(e)}function Y(e){throw new Q(14,e)}function Ht(e){throw new Error(e)}function Kt(e){throw new Q(13,e)}function Qs(e){throw new Error(e)}function Vs(e){throw new Ps(e)}function Ws(){Y("Operation does not support curves.")}function js(e){e&&xt(e)&&Ws()}function Ys(e){e&&Jt(e.getGeometryType())&&Y("Unsupported geometry type.")}function ts(e){e===V.enumGeometryCollection&&W("Geometry_collection instances are not supported in this operation")}function $s(e){ts(e.getGeometryType())}function Xs(e){W(`bad wkid: ${e}`)}function Js(e){let t="bad wkt: ";t+=e,t+="...",W(t)}function Hs(e,t){e||W(t)}let ot=class Rs{constructor(t){this.sum=t,this.compensation=0}assign(t){return this.compensation=t.compensation,this.sum=t.sum,this}reset(){this.sum=this.compensation=0}resetToStart(t){this.sum=t,this.compensation=0}normalize(){const t=[Number.NaN];this.sum=st(this.sum,this.compensation,t),this.compensation=t[0]}add(t){const s=this.sum+t;let i;if(Math.abs(this.sum)>=Math.abs(t)){const n=this.sum-s+t;i=this.compensation+n}else{const n=t-s+this.sum;i=this.compensation+n}this.sum=s,this.compensation=i}sub(t){this.add(-t)}addProduct(t,s){const i=[0],n=ut(t,s,i);this.add(n),this.add(i[0])}mul(t){const s=new Rs(0);s.addProduct(this.sum,t),s.addProduct(this.compensation,t),this.assign(s)}getResult(){return this.sum+this.compensation}pe(t){return this.add(t),this}me(t){return this.add(-t),this}};const Ks=0x00000000ffffffffn,ti=0x0000ffffn,si=0x000000ffn,ii=0x0fn,ei=0xffff0000n,ni=0xff00n,ri=0xf0n,oi=[5,1,2,1,3,1,2,1,4,1,2,1,3,1,2,1],hi=[-1,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3];function dt(e){let t=0;return e&ti||(t+=16,e>>=16n),e&si||(t+=8,e>>=8n),e&ii||(t+=4,e>>=4n),t+oi[Number(BigInt.asUintN(4,e))]}function ai(e){let t=0;return e&ei&&(t+=16,e>>=16n),e&ni&&(t+=8,e>>=8n),e&ri&&(t+=4,e>>=4n),t+hi[Number(BigInt.asUintN(4,e))]+1}function ss(e){let t=0;return e&Ks||(t=32,e>>=32n),t+dt(BigInt.asUintN(32,e))}function ui(e){let t=0;return 0xffffffff00000000n&e&&(t=32,e>>=32n),t+ai(e)}let bt=class rt{constructor(t,s){if(this.m_EnvelopeType=1,t!==void 0){if(t instanceof rt)return this.vmin=t.vmin,void(this.vmax=t.vmax);this.vmin=t,this.vmax=s,this.normalize()}else this.setEmpty()}static construct(t,s){return new rt(t,s)}static constructEmpty(){return new rt}setCoords(t,s){this.vmin=t,this.vmax=s,this.normalize()}setCoordsFromEnvelope(t){this.vmin=t.vmin,this.vmax=t.vmax}setEmpty(){this.vmin=Number.NaN,this.vmax=Number.NaN}getCenter(){return .5*(this.vmin+this.vmax)}equalsRange(t,s){return Et(this.vmin,t)&&Et(this.vmax,s)}equals(t,s){return!(!this.isEmpty()||!t.isEmpty())||(s!==void 0?Math.abs(this.vmin-t.vmin)<=s&&Math.abs(this.vmax-t.vmax)<=s:this.vmin===t.vmin&&this.vmax===t.vmax)}width(){return this.vmax-this.vmin}isEmpty(){return Number.isNaN(this.vmin)||Number.isNaN(this.vmax)}isZero(){return this.vmin===this.vmax}setInfinite(){this.vmin=Number.NEGATIVE_INFINITY,this.vmax=Number.POSITIVE_INFINITY}move(t){this.isEmpty()||(this.vmin+=t,this.vmax+=t)}contains(t){return t.vmin>=this.vmin&&t.vmax<=this.vmax}containsCoordinate(t){return t>=this.vmin&&t<=this.vmax}containsRightExclusive(t){return t>=this.vmin&&t<this.vmax}containsExclusiveCoordinate(t){return t>this.vmin&&t<this.vmax}containsExclusive(t){return t.vmin>this.vmin&&t.vmax<this.vmax}isIntersecting(t){return this.vmin<=t.vmin?this.vmax>=t.vmin:t.vmax>=this.vmin}mergeCoordinate(t){if(this.isEmpty())return this.vmin=t,void(this.vmax=t);this.mergeNeCoordinate(t)}merge(t){if(t.isEmpty())return;const s=t.vmin,i=t.vmax;this.mergeCoordinate(s),this.mergeCoordinate(i)}mergeNe(t){const s=t.vmin,i=t.vmax;this.mergeNeCoordinate(s),this.mergeNeCoordinate(i)}mergeNeCoordinate(t){t<this.vmin?this.vmin=t:t>this.vmax&&(this.vmax=t)}intersect(t){this.isEmpty()||t.isEmpty()?this.setEmpty():(this.vmin<t.vmin&&(this.vmin=t.vmin),this.vmax>t.vmax&&(this.vmax=t.vmax),this.vmin>this.vmax&&this.setEmpty())}inflate(t){this.isEmpty()||(this.vmin-=t,this.vmax+=t,this.vmax<this.vmin&&this.setEmpty())}normalize(){this.vmin<=this.vmax||(this.vmin>this.vmax?this.vmax=H(this.vmin,this.vmin=this.vmax):this.setEmpty())}isValid(){return this.isEmpty()||this.vmin<=this.vmax}snapClip(t){return Dt(t,this.vmin,this.vmax)}calculateToleranceFromEnvelope(){return this.isEmpty()?At():(Math.abs(this.vmin)+Math.abs(this.vmax)+1)*At()}static unit(){return li}normalizeNoNAN(){this.vmin>this.vmax&&(this.vmax=H(this.vmin,this.vmin=this.vmax))}setCoordsNoNAN(t,s){this.vmin=t,this.vmax=s,this.normalizeNoNAN()}clone(){return new rt(this.vmin,this.vmax)}};const li=new bt(0,1);class R{static getNAN(){return new R(Number.NaN)}constructor(t,s){this.m_value=t??0,this.m_eps=s??0}[Symbol.toPrimitive](t){return this}clone(){return new R(this.m_value,this.m_eps)}assign(t){return this.m_value=t.m_value,this.m_eps=t.m_eps,this}scaleError(t){this.m_eps*=t}setError(t){this.m_eps=t}set(t,s){return this.m_value=t,this.m_eps=s??0,this}setWithEps(t,s){return s===void 0&&(s=1),this.m_value=t,this.m_eps=R.ulp(t)*s,this}setE(t){return this.m_value=t.m_value,this.m_eps=t.m_eps,this}precise(){return new R(this.m_value)}value(){return this.m_value}toDouble(){return this.m_value}eps(){return this.m_eps}resetError(){return this.m_eps=0,this}absThis(){return this.m_value=Math.abs(this.m_value),this}add(t){return this.clone().addThis(t)}addE(t){return this.clone().addThisE(t)}addThisE(t){const s=this.m_value+t.m_value,i=this.m_eps+t.m_eps+R.ulp(s);return this.m_value=s,this.m_eps=i,this}addThis(t){const s=this.m_value+t,i=this.m_eps+R.ulp(s);return this.m_value=s,this.m_eps=i,this}subE(t){return this.clone().subThisE(t)}sub(t){return this.clone().subThis(t)}subThisE(t){const s=this.m_value-t.m_value,i=this.m_eps+t.m_eps+R.ulp(s);return this.m_value=s,this.m_eps=i,this}subThis(t){const s=this.m_value-t,i=this.m_eps+R.ulp(s);return this.m_value=s,this.m_eps=i,this}setAddE(t,s){return this.m_value=t.m_value+s.m_value,this.m_eps=t.m_eps+s.m_eps+R.ulp(this.m_value),this}setAdd(t,s){return this.m_value=t+s,this.m_eps=R.ulp(this.m_value),this}setAddEN(t,s){return this.m_value=t.m_value+s,this.m_eps=t.m_eps+R.ulp(this.m_value),this}setAddNE(t,s){return this.m_value=t+s.m_value,this.m_eps=s.m_eps+R.ulp(this.m_value),this}setSubE(t,s){return this.m_value=t.m_value-s.m_value,this.m_eps=t.m_eps+s.m_eps+R.ulp(this.m_value),this}setSub(t,s){return this.m_value=t-s,this.m_eps=R.ulp(this.m_value),this}setSubEN(t,s){return this.m_value=t.m_value-s,this.m_eps=t.m_eps+R.ulp(this.m_value),this}setSubNE(t,s){return this.m_value=t-s.m_value,this.m_eps=s.m_eps+R.ulp(this.m_value),this}mulThisE(t){const s=this.m_value*t.m_value;return this.m_eps=this.m_eps*Math.abs(t.m_value)+t.m_eps*Math.abs(this.m_value)+this.m_eps*t.m_eps+R.ulp(s),this.m_value=s,this}mulThis(t){const s=this.m_value*t;return this.m_eps=this.m_eps*Math.abs(t)+R.ulp(s),this.m_value=s,this}mul(t){return this.clone().mulThis(t)}mulE(t){return this.clone().mulThisE(t)}setMulE(t,s){const i=t.m_value*s.m_value;return this.m_eps=t.m_eps*Math.abs(s.m_value)+s.m_eps*Math.abs(t.m_value)+t.m_eps*s.m_eps+R.ulp(i),this.m_value=i,this}setMul(t,s){return this.m_value=t*s,this.m_eps=R.ulp(this.m_value),this}setMulEN(t,s){return this.setE(t),this.mulThis(s)}setMulNE(t,s){return this.setE(s),this.mulThis(t)}mulThisByPower2(t){return this.m_value*=t,this.m_eps*=Math.abs(t),this}static st_mulByPower2(t,s){return new R(t.m_value,t.m_eps).mulThisByPower2(s)}divE(t){return this.clone().divThisE(t)}divThisE(t){const s=Math.abs(t.m_value),i=this.m_value/t.m_value;let n=(this.m_eps+Math.abs(i)*t.m_eps)/s;if(t.m_eps>.01*s){const r=t.m_eps/s;n*=1+(1+r)*r}return this.m_value=i,this.m_eps=n+R.ulp(i),this}divThis(t){const s=Math.abs(t);return this.m_value/=t,this.m_eps=this.m_eps/s+R.ulp(this.m_value),this}setDivE(t,s){return this.setE(t),this.divThisE(s)}setDiv(t,s){return this.m_value=t/s,this.m_eps=R.ulp(this.m_value),this}setDivEN(t,s){return this.setE(t),this.divThis(s)}setDivNE(t,s){return this.set(t),this.divThisE(s)}divThisByPower2(t){return this.m_value/=t,this.m_eps/=Math.abs(t),this}invThis(){return this.setE(tt.clone().divThisE(this)),this}sqrt(){return this.clone().sqrtThis()}sqrtThis(){let t,s;return this.m_value>=0?(t=Math.sqrt(this.m_value),s=this.m_value>10*this.m_eps?.5*this.m_eps/t:this.m_value>this.m_eps?t-Math.sqrt(this.m_value-this.m_eps):Math.max(t,Math.sqrt(this.m_value+this.m_eps)-t),s+=R.ulp(t)):this.m_value<-this.m_eps?(t=Number.NaN,s=Number.NaN):(t=0,s=Math.sqrt(this.m_eps)),this.m_value=t,this.m_eps=s,this}sqr(){return this.clone().sqrThis()}sqrThis(){const t=this.m_value*this.m_value;return this.m_eps=2*this.m_eps*Math.abs(this.m_value)+this.m_eps*this.m_eps+R.ulp(t),this.m_value=t,this}setSin(t){const s=Math.sin(t.m_value),i=Math.cos(t.m_value);this.m_value=s;const n=Math.abs(s),r=Math.abs(t.value());return this.m_eps=(Math.abs(i)+.5*n*t.m_eps)*t.m_eps+R.ulp(n+r),this}static ulp(t){let s=it(t);const i=((0x7ff0000000000000n&s)>>52n)-1075n;return i>-1023n?(s=i+0x3ffn<<52n,oe(s)):t===0?0:Number.MIN_VALUE}setCos(t){const s=Math.sin(t.m_value),i=Math.cos(t.m_value);this.m_value=i;const n=Math.abs(i),r=Math.abs(t.value());return this.m_eps=(Math.abs(s)+.5*n*t.m_eps)*t.m_eps+R.ulp(n+r),this}static st_cosAndSin(t,s,i){const n=Math.sin(t.m_value),r=Math.cos(t.m_value);i.m_value=n,s.m_value=r;const o=Math.abs(n),h=Math.abs(r),a=Math.abs(t.value());i.m_eps=(Math.abs(r)+.5*o*t.m_eps)*t.m_eps+R.ulp(o+a),s.m_eps=(Math.abs(n)+.5*h*t.m_eps)*t.m_eps+R.ulp(h+a)}negate(){return this.clone().negateThis()}negateThis(){return this.m_value=-this.m_value,this}setAbs(){return this.m_value=Math.abs(this.m_value),this}isInInterval(t){return bt.construct(this.m_value-this.m_eps,this.m_value+this.m_eps).isIntersecting(t)}eq(t){return Math.abs(this.m_value-t.m_value)<=this.m_eps+t.m_eps}ne(t){return!this.eq(t)}gt(t){return this.m_value-t.m_value>this.m_eps+t.m_eps}lt(t){return t.m_value-this.m_value>this.m_eps+t.m_eps}ge(t){return!this.lt(t)}le(t){return!this.gt(t)}tolEQ(t,s){return Math.abs(this.m_value-t.m_value)<=s||this.eq(t)}tolNE(t,s){return!this.tolEQ(t,s)}tolGT(t,s){return this.m_value-t.m_value>s&&this.gt(t)}tolLT(t,s){return t.m_value-this.m_value>s&&this.lt(t)}tolGE(t,s){return!this.tolLT(t,s)}tolLE(t,s){return!this.tolGT(t,s)}isZero(){return Math.abs(this.m_value)<=this.m_eps}isFuzzyZero(){return this.isZero()&&this.m_eps!==0}tolIsZero(t){return Math.abs(this.m_value)<=Math.max(this.m_eps,t)}setPi(){this.setE(mi)}setEuler(){this.set(2.718281828459045,vt())}static size(){return 1}}function z(e,t){const s=lt(e),i=lt(t),n=53-ss(s),r=53-ss(i);return(n>=0?n:0)+(r>=0?r:0)<=52}function ht(e,t){const s=e+t;return s-e===t&&s-t===e}function L(e,t){const s=e-t;return e-s===t&&t+s===e}function vt(){return J()}R.dimensions=1;const mi=new R(Math.PI,.5*vt()),ci=new R(0,0),tt=new R(1,0),yi=new R(4,0);function xi(e,t,s){return e.addE(t.subE(e).mulE(s))}function fi(e,t,s){return t.subE(t.subE(e).mulE(tt.subE(s)))}function di(e){return Math.atanh(e)}function bi(e){let t;if(e===0)t=1;else if(Math.abs(e)>.01)t=di(e)/e;else{let s;const i=-36.841361487904734;t=0;const n=e*e;for(let r=2*Math.trunc(i/Math.log(n)+2.5)-1;r>1;r-=2)s=1/r,t=(t+s)*n;t+=1}return t}function wt(e){const t=Math.PI*Math.PI/6;let s;if(e===1)s=t;else if(e>1)s=t;else if(e===0)s=e;else if(e<0){const i=1+(e=Math.abs(e)),n=Math.log(i);s=n*n/-2-wt(e/i)}else if(e>.5){const i=1-e,n=Math.log(e)*Math.log(i);s=t-wt(i)-n}else{s=0;const i=1+Math.trunc(-16*Math.log(10)/Math.log(e)+1.5);let n=i;for(let r=i;r>0;r--,n-=1)s*=e,s+=1/(n*n);s*=e}return s}function vi(e,t){const s=t*e;if(Math.abs(t)<.1){let i=0;for(let n=60;n>=1;n--)i*=s,i+=1/n/n;return i*=e,i}return wt(s)/t}function wi(e,t){return e<t?Tt(e,t):Tt(t,e)}function Ni(e,t){const s=Math.abs(e);return t>=0?s:-s}function pi(e){return Math.round(e)}function is(e,t,s,i,n){n[0]=t[0]+(s[0]-t[0])*i,n[1]=t[1]+(s[1]-t[1])*i,e===3&&(n[2]=t[2]+(s[2]-t[2])*i)}function es(e,t,s,i,n){n[0]=s[0]-(s[0]-t[0])*(1-i),n[1]=s[1]-(s[1]-t[1])*(1-i),e===3&&(n[2]=s[2]-(s[2]-t[2])*(1-i))}function Mi(e,t,s,i,n){i<=.5?is(e,t,s,i,n):es(e,t,s,i,n)}function _i(e,t,s,i,n){n[0]=t[0].addE(s[0].subE(t[0]).mulE(i)),n[1]=t[1].addE(s[1].subE(t[1]).mulE(i))}function gi(e,t,s,i,n){n[0]=s[0].subE(s[0].subE(t[0]).mulE(tt.subE(i))),n[1]=s[1].subE(s[1].subE(t[1]).mulE(tt.subE(i)))}function at(e,t,s){let i;return i=s<=.5?e+(t-e)*s:t-(t-e)*(1-s),i}function Ci(e,t,s){return e+(t-e)*s}function Ri(e,t,s){return t-(t-e)*(1-s)}function Nt(e,t,s,i){s<=.5?(i.x=e.x+(t.x-e.x)*s,i.y=e.y+(t.y-e.y)*s):(i.x=t.x-(t.x-e.x)*(1-s),i.y=t.y-(t.y-e.y)*(1-s))}function Ti(e,t,s,i){s<=.5?(i.x=e.x+(t.x-e.x)*s,i.y=e.y+(t.y-e.y)*s,i.z=e.z+(t.z-e.z)*s):(i.x=t.x-(t.x-e.x)*(1-s),i.y=t.y-(t.y-e.y)*(1-s),i.z=t.z-(t.z-e.z)*(1-s))}function O(e){return e*e}function Ei(e){return e*e*e}function Ii(e){return 1/Math.sqrt(e)}function Ai(e){return e<0?-1:e>0?1:0}function Di(e,t,s,i){const n=[0],r=[0],o=[0];return st(ut(e,s,n),ut(t,i,r),o)+(n[0]+r[0]+o[0])}const ns=[0],Pi=[0];function qi(e,t,s){return zi(ut(e,t,ns),s,ns[0],Pi)}const pt=[0],Mt=[0],_t=[0],gt=[0];function ut(e,t,s){const i=e*t;return rs(e,pt,Mt),rs(t,_t,gt),s[0]=Mt[0]*gt[0]-(i-pt[0]*_t[0]-Mt[0]*_t[0]-pt[0]*gt[0]),i}function rs(e,t,s){const i=134217729*e;t[0]=i-(i-e),s[0]=e-t[0]}const os=[0],hs=[0];function zi(e,t,s,i){const n=st(e,t,os),r=st(n,s,hs);return st(r,os[0]+hs[0],i)}function st(e,t,s){const i=e+t;return Math.abs(e)>Math.abs(t)?s[0]=e-i+t:s[0]=t-i+e,i}function Si(e,t){return e%t}function Ct(e){const t=1-e;if(t===0)return 1;let s;if(t<=.01){const i=t,n=Math.log(i);s=1+i*(.4431471805599453-.25*n+i*(.05680519270997949-.09375*n+i*(.02183137044373718-.05859375*n+i*(.011544521417308362-.042724609375*n+i*(.00714200031339596-.0336456298828125*n+i*(.004854743337164948-.027757644653320312*n+i*(.003514687963781376-.023627042770385742*n)))))))}else{if(e<.016){const i=e;return B()*(1-i*(.25+i*(.046875+i*(.01953125+i*(.01068115234375+i*(.0067291259765625+i*(.004626274108886719+i*(.0033752918243408203+i*.0025710230693221092))))))))}s=us(0,t,1)-e*ls(0,t,1)/3}return Dt(s,1,B())}function as(e,t,s=Number.NaN){if(_(t>=0&&t<=1),t===0)return e;let i=1,n=e;if(n<0&&(n=-n,i=-1),t===1){const c=Math.round(n/Pt()),l=n-c*Pt();return i*(2*c+Math.sin(l))}const r=B(),o=Math.floor(n/r);1&o?n=(o+1)*r-n:n-=o*r;const h=Math.sin(n),a=Number.isNaN(s)?Ct(t):s;let u;if(h===1)u=a+Math.sqrt(1-t)*(n-r);else{const c=n*n;if(.01424*Math.pow(c,4)<=2*J())u=n*(1+c*t*(-1/6+c*((4-3*t)/120-(16+(45*t-60)*t)/5040*c)));else if(t<=.01){const l=Math.sin(2*n),y=Math.sin(4*n),N=Math.sin(6*n),b=Math.sin(8*n),f=Math.sin(10*n);u=n+t*((2*-n+l)/8+t*((-3*n+2*l-.25*y)/64+t*((-20*n+15*l-3*y+N/3)/1024+t*(5*(-140*n+112*l-28*y+16/3*N-.5*b)/65536+7*t*((-63*n+52.5*l-15*y+3.75*N-.625*b+.05*f)/65536+t*(-693*n+594*l-185.625*y+1.375*N-12.375*b+1.8*f-.125*Math.sin(12*n))/1048576)))))}else{const l=h*h,y=Math.cos(n),N=y*y,b=ms(h,y,t);u=h*(us(N,b,1)-t*l*ls(N,b,1)/3)}}return 1&o?u=a*(o+1)-u:u+=a*o,i*u}function Zi(e,t,s=Number.NaN){if(e===0)return 0;let i=1,n=e;e<0&&(n=-n,i=-1);const r=Number.isNaN(s)?Ct(t):s,o=Math.floor(n/r);1&o?n=(o+1)*r-n:n-=o*r;let h=n<=0?0:n>=r?B():Fi(n,t,r);return 1&o?h=B()*(o+1)-h:h+=B()*o,i*h}function us(e,t,s){_((e!==0?1:0)+(t!==0?1:0)+1>1);let i=e,n=t,r=s;for(;;){const o=Math.sqrt(i*n)+Math.sqrt(n*r)+Math.sqrt(r*i);i=.25*(i+o),n=.25*(n+o),r=.25*(r+o);const h=(i+n+r)/3,a=(h-i)/h,u=(h-n)/h,c=(h-r)/h;if(Math.abs(a)<=.0024&&Math.abs(u)<=.0024&&Math.abs(c)<=.0024){const l=a*u-c*c,y=a*u*c;return(1+(1/24*l-.1-3/44*y-5*l*l/208+l*y/16)*l+(1/14+3*y/104)*y)/Math.sqrt(h)}}}function ls(e,t,s){_(e!==0||t!==0);let i=e,n=t,r=s;const o=new ot(0);let h=1;for(;;){const a=.2*(i+n+3*r),u=(a-i)/a,c=(a-n)/a,l=(a-r)/a;if(Math.abs(u)<=.0015&&Math.abs(c)<=.0015&&Math.abs(l)<=.0015){const w=u*c,v=l*l,C=w-v,E=w-6*v,I=E+C+C,A=3/26,D=E*(.25*(9/22)*E-.21428571428571427-1.5*A*l*I),T=l*(1/6*I+l*(-.4090909090909091*C+l*A*w));return 3*o.getResult()+h*(1+D+T)/(a*Math.sqrt(a))}const y=Math.sqrt(i),N=Math.sqrt(n),b=Math.sqrt(r),f=y*(N+b)+N*b;o.add(h/(b*(r+f))),h*=.25,i=.25*(i+f),n=.25*(n+f),r=.25*(r+f)}}function ms(e,t,s){return e<.999?1-s*O(e):1-s+s*O(t)}function Fi(e,t,s){if(t===0)return e;if(t===1)return Math.asin(e);let i=0,n=!0;if(e<.2){const o=e*e,h=e*(1+o*t*(1/6+o*((13*t-4)/120+(16-284*t+493*t*t)/5040*o))),a=Math.abs(t*(4944*t-64-31224*t*t+37369*t*t*t)/362880*Math.pow(e,9));if(a<Math.abs(h)*J())return h;i=h,n=a>.1*h}if(n){const o=1-t,h=1-e/s,a=Math.sqrt(h*h+o*o),u=Math.atan2(o,e+J());i=B()+Math.sqrt(a)*(u-B())}let r=0;for(let o=0;o<7;o++){r=as(i,t,s);const h=ms(Math.sin(i),Math.cos(i),t);if(i-=(r-e)/Math.sqrt(h),o>0&&Math.abs(r-e)<=4*J()*e)break}return i}function Li(e,t,s,i,n){return e===0?i===0?t:i===1?s:n:e===1?i===0?t:i===1?s:at(t,s,i):(e===2&&Y("angular interpolation"),void Y(""))}function Gi(e,t,s,i,n,r,o,h){if(e===0)for(let a=0;a<r;++a)i[a+n]=o===0?t[a]:o===1?s[a]:h;else if(e===1)if(o===0)j(i,t,n,0,r);else if(o===1)j(i,s,n,0,r);else for(let a=0;a<r;++a)i[a+n]=at(t[a],s[a],o);else if(e===2)if(o===0)j(i,t,n,0,r);else if(o===1)j(i,s,n,0,r);else{let a=0;for(let u=0,c=n;u<r;++u,++c)i[c]=at(t[u],s[u],o),a+=i[c]*i[c];if(a>0){a=Math.sqrt(a);for(let u=n;u<n+r;++u)i[u]/=a}else{for(let u=n;u<n+r;++u)i[u]=0;i[n]=1}}else Y("")}function j(e,t,s,i,n){if(n===0)return;let r=0,o=s,h=i;for(;r++<n;)e[o++]=t[h++]}function Bi(e,t,s){let i=0;for(let n=0;!i&&n<s;++n)i=e[n]-t[n];return i}function H(e,t){return e}function cs(e){e.sort((t,s)=>t<s?-1:t>s?1:0)}function ki(e,t){const s=e.slice(0,t);cs(s),j(e,s,0,0,t)}function Oi(e,t,s,i){const n=e.slice(t,t+s);n.sort(i),j(e,n,t,0,s)}function Ui(e,t){return e<t?-1:e>t?1:0}function Qi(e,t,s,i){return e<s?-1:e>s?1:t<i?-1:t>i?1:0}function Vi(e,t){if(e.length<2)return e.length;let s=0;for(let i=1;i<e.length;++i)t(e[i],e[s])||(s++,e[i]=H(e[s],e[s]=e[i]));return 1+s}function Wi(e,t){e[t]=e.at(-1),e.pop()}function ji(e,t=!1){return{[Symbol.dispose](){this.bForget||e()},bForget:t}}function Yi(e,t,s){e.length=t,e.fill(s)}function $i(e,t,s){e.length=s;for(let i=0;i<s;++i)e[i]=new t}function Rt(e,t){const s=new Array(t);for(let i=0;i<t;++i)s[i]=new e;return s}function Xi(e,t,s){for(let i=0;i<s;++i)e[i].assign(t[i]);return s}function Ji(e,t){const s=e.slice(0,t);for(let i=0;i<t;++i)s[i]=s[i].clone();return s}function Hi(e){return Array.from({length:e},()=>null)}function Ki(e,t){return Array.from({length:t},()=>e())}function ys(e,t){const s=new Array(e);return s.fill(t),s}function te(e,t){return t in e&&Object.getOwnPropertyNames(e).length===1}class se{constructor(...t){this.m_elts=t}get length(){return this.m_elts.length}at(t){return this.m_elts[t]}[Symbol.dispose](){for(const t of this.m_elts)t[Symbol.dispose]()}}function Tt(e,t){return{first:e,second:t}}const xs=Math.PI,fs=2*Math.PI,ds=.5*Math.PI;class ie{constructor(t,s){this.m_cr=t,this.m_cc=s,this.m_v=ys(t*s,0)}get(t,s){return this.m_v[t*this.m_cc+s]}set(t,s,i){this.m_v[t*this.m_cc+s]=i}inc(t,s){return++this.m_v[t*this.m_cc+s]}}const bs=new ArrayBuffer(8),vs=new Float64Array(bs),ws=new BigUint64Array(bs),ee=0x0fffffffffffffn,ne=0x7ff0000000000000n;function re(){return Number.EPSILON*Re}function it(e){return vs[0]=e,ws[0]}function oe(e){return ws[0]=e,vs[0]}function lt(e){return it(e)&ee}function Ns(e){return Number((it(e)&ne)>>52n)}function $(e){if(e===0n)return-1n;if(e===1n||-1n===e)return 0n;e<0n&&(e=-e);let t=0n,s=512n,i=1n<<t+s;for(;e>=i;)t+=s,s<<=1n,i<<=s;let n=t;s>>=1n;let r=n+s;for(;s>0n;)e<1n<<r||(n=r),s>>=1n,r=n+s;return n}function Et(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}function he(e,t,s){return e===t||Math.abs(e-t)<=s||Number.isNaN(e)&&Number.isNaN(t)}function ae(e,t){return e<t?-1:e>t?1:0}function ue(e,t){if(e<t)return-1;if(e>t)return 1;if(e===t)return 0;{const s=Number.isNaN(e),i=Number.isNaN(t);return s<i?-1:s>i?1:0}}function le(){return 2147483647}function me(){return 32767}function It(){return 2147483647}function ce(){return-2147483648}const mt=It(),ye=BigInt(mt),ps=2166136261,et=16777619;function xe(e){let t=ps,s=e;return t=(t^255&s)*et,s>>=8,t=(t^255&s)*et,s>>=8,t=(t^255&s)*et,s>>=8,t=(t^255&s)*et,t&mt}const fe=14695981039346656037n,X=1099511628211n;function de(e){let t=fe,s=e;return t=(t^0xffn&s)*X,s>>=8n,t=(t^0xffn&s)*X,s>>=8n,t=(t^0xffn&s)*X,s>>=8n,t=(t^0xffn&s)*X,s>>=8n,t=(t^0xffn&s)*X,s>>=8n,t=(t^0xffn&s)*X,s>>=8n,t=(t^0xffn&s)*X,t&ye}function be(e){return 1103515245*e+12345&2147483647}function ve(e){let t=ps;for(let s=0,i=e.length;s<i;++s)t=(t^e.charCodeAt(s))*et;return t&mt}function ct(e,t){return t+2654435769+(e<<6)+(e>>2)&mt}function we(e,t){return ct(e,_s(t))}function Ms(e){return ct(3735928559,e)}function Ne(e,t){return ct(e,Ms(t))}function pe(e){return xe(e)}function _s(e){return Number(de(e))}function Me(e){return gs(e)}function _e(e){return _s(it(Me(e)))}function ge(e){return be(e)}const Ce=100,Re=100;function At(){return Number.EPSILON*Ce}function Te(){return .38196601125010515}function Ee(){return 1.4142135623730951}function J(){return Number.EPSILON}function Ie(e,t,s){return e===t||e===s}function Dt(e,t,s){return e>=t?e<=s?e:s:t}function Ae(e,t,s){const i=e[0];if(i>=t){if(i<=s)return!1;e[0]=s}else e[0]=t;return!0}function De(e,t){return e>=t?t:e<-t?-t:e}function Pt(){return xs}function Pe(){return fs}function B(){return ds}const qe=3*B();function ze(){return qe}function gs(e){return e+0}function Cs(e){return{v:e}}class M{constructor(){this.m_rn=Cs(0n),this.m_rd=Cs(1n),this.m_bNaN=!1,this.m_bNormalized=!1,this.m_power=0,this.m_sign=0}static constructAssign(t,s){const i=t.clone();return s!==void 0&&i.limitPrecisionThis(s),i}static constructDouble(t){return new M().setDouble(t)}static constructInt64(t){return new M().setInt64(t)}static constructRational(t,s){return new M().setRational(t,s)}static constructInt32(t){return this.constructInt64(BigInt(Math.trunc(t)))}[Symbol.toPrimitive](t){return this}compare(t){return this.lt(t)?-1:this.gt(t)?1:0}assignCopy(t){return this.setThis(t)}abs(){return this.clone().absThis()}absThis(){return this.isNAN()||(this.m_sign*=this.m_sign),this}clone(){return new M().setThis(this)}setThis(t){return this.m_bNaN=t.m_bNaN,this.m_bNormalized=t.m_bNormalized,this.m_rn.v=t.m_rn.v,this.m_rd.v=t.m_rd.v,this.m_power=t.m_power,this.m_sign=t.m_sign,this}setZero(){return this.m_rn.v=0n,this.m_rd.v=1n,this.m_bNaN=!1,this.m_power=0,this.m_bNormalized=!0,this.m_sign=0,this}setDouble(t){if(this.setZero(),t===0)return this;if(Number.isInteger(t)&&Math.abs(t)<It())return this.setInt32(t);const s=it(t),i=(s&M.s_em)>>52n,n=!!(s&M.s_sm),r=s&M.s_fm;if(i===M.s_emax)return r?(this.m_rn.v=this.m_rd.v=0n,this.m_bNaN=!0,this):(this.m_rn.v=n?-1n:1n,this.m_rd.v=0n,this);i===0n&&Y("denormalized numbers not yet implemented");const o=i-1023n,h=o>=0n?o:0n,a=o<0n?-o:0n;return this.m_rn.v=(1n<<52n|r)<<h,this.m_rd.v=1n<<52n+a,this.m_sign=n?-1:1,this.m_bNormalized=!1,this.normalizeThis()}setInt64(t){return t===0n?this.setZero():(this.m_bNaN=!1,this.m_sign=t>0n?1:-1,this.m_rn.v=t>0n?t:-t,this.m_rd.v=1n,this.m_power=0,this.m_bNormalized=!1,this.normalizeThis())}setRational(t,s){return t===0n?s===0n?this.setNAN():this.setZero():s===0n?t>0n?this.setPositiveInf():this.setNegativeInf():(this.m_sign=(t>0n?1:-1)*(s>0n?1:-1),this.m_rn.v=t>0n?t:-t,this.m_rd.v=s>0n?s:-s,this.m_power=0,this.m_bNormalized=!1,this.normalizeThis())}setInt32(t){return this.setInt64(BigInt(Math.trunc(t)))}getDouble(){return this.convertToDouble()}toDouble(){return this.convertToDouble()}value(){return this.convertToDouble()}isNAN(){return this.m_bNaN}isPositiveInf(){return!this.isNAN()&&this.m_rd.v===0n&&this.m_sign===1}isNegativeInf(){return!this.isNAN()&&this.m_rd.v===0n&&this.m_sign===-1}isFinite(){return!this.isNAN()&&this.m_rd.v!==0n}setNAN(){return this.m_bNaN=!0,this.m_rn.v=0n,this.m_rd.v=0n,this.m_power=0,this.m_bNormalized=!0,this}setPositiveInf(){return this.m_rn.v=1n,this.m_rd.v=0n,this.m_bNaN=!1,this.m_bNormalized=!0,this.m_sign=1,this.m_power=0,this}setNegativeInf(){return this.m_rn.v=1n,this.m_rd.v=0n,this.m_bNaN=!1,this.m_bNormalized=!0,this.m_sign=-1,this.m_power=0,this}subThis(t){if(t.isNAN()&&this.setNAN(),this.isPositiveInf()&&t.isPositiveInf())this.setNAN();else{if(this.isPositiveInf()&&t.isNegativeInf())return this.setPositiveInf(),this;if(this.isNegativeInf()&&t.isNegativeInf())this.setNAN();else if(this.isNegativeInf()&&t.isPositiveInf())return this.setNegativeInf(),this}return this.isNAN()?this:this.opPlusMinus(t,!1)}thisSubAbs(t){return _(0),this}mulThis(t){return t.isNAN()&&this.setNAN(),this.isNAN()?this:(this.m_sign*=t.m_sign,this.m_sign===0?this.setZero():(this.m_rn.v*=t.m_rn.v,this.m_rd.v*=t.m_rd.v,this.m_power+=t.m_power,this.m_bNormalized=!1,this.normalizeThis(),this))}mulDoubleThis(t){return this.mulThis(M.constructDouble(t))}thisMulInt64(t){return _(0),this}thisMulInt32(t){return _(0),this}divThis(t){return this.mulThis(t.clone().invertThis())}divDoubleThis(t){return this.divThis(M.constructDouble(t))}addDoubleThis(t){return this.addThis(M.constructDouble(t))}subDoubleThis(t){return this.subThis(M.constructDouble(t))}mul(t){return this.clone().mulThis(t)}mulBigIntThis(t){return this.mulThis(M.constructInt64(t))}mulDouble(t){return this.clone().mulThis(M.constructDouble(t))}div(t){return this.clone().divThis(t)}divDouble(t){return this.clone().divDoubleThis(t)}add(t){return this.clone().addThis(t)}fmSubThis(t,s){return this.subThis(t.clone().mulThis(s))}fmAddThis(t,s){return this.addThis(t.clone().mulThis(s))}addThis(t){if(t.isNAN()&&this.setNAN(),this.isPositiveInf()&&t.isPositiveInf())return this.setPositiveInf(),this;if(this.isPositiveInf()&&t.isNegativeInf())this.setNAN();else{if(this.isNegativeInf()&&t.isNegativeInf())return this.setNegativeInf(),this;this.isNegativeInf()&&t.isPositiveInf()&&this.setNAN()}return this.isNAN()?this:this.opPlusMinus(t,!0)}addDouble(t){return this.clone().addThis(M.constructDouble(t))}sub(t){return this.clone().subThis(t)}subDouble(t){return this.clone().subThis(M.constructDouble(t))}isZero(){return this.m_sign===0}equals(t){return this.clone().subThis(t).isZero()}lt(t){return!this.isNAN()&&!t.isNAN()&&!(this.isPositiveInf()&&t.isPositiveInf()||this.isNegativeInf()&&t.isNegativeInf())&&!this.isPositiveInf()&&(!!t.isPositiveInf()||this.clone().sub(t).LZ())}absLessAbs(t){return this.abs().lt(t.abs())}gt(t){return this.clone().sub(t).GZ()}lte(t){return this.sub(t).LEZ()}gte(t){return this.sub(t).GEZ()}normalizeThis(){if(this.m_bNormalized)return this;if(this.m_rn.v===0n)return this.setZero();let t=0,s=0xffffffffn;for(;(this.m_rn.v&s)===0n&&s<=this.m_rn.v;)s<<=32n,t+=32;s&=this.m_rn.v,s>>=BigInt(t),t+=dt(BigInt.asUintN(32,s))-1;let i=0;for(s=0xffffffffn;(this.m_rd.v&s)===0n&&s<=this.m_rd.v;)s<<=32n,i+=32;return s&=this.m_rd.v,s>>=BigInt(i),i+=dt(BigInt.asUintN(32,s))-1,this.m_rn.v>>=BigInt(t),this.m_rd.v>>=BigInt(i),this.m_power+=t-i,this.m_rn.v>1n&&this.m_rd.v>1n&&(this.m_rn.v%this.m_rd.v===0n?(this.m_rn.v/=this.m_rd.v,this.m_rd.v=1n):this.m_rd.v%this.m_rn.v===0n&&(this.m_rd.v/=this.m_rn.v,this.m_rn.v=1n)),this.m_bNormalized=!0,this}negateThis(){return this.isNAN()||(this.m_sign*=-1),this}negate(){return this.clone().negateThis()}invertThis(){return this.isNAN()?this:this.isPositiveInf()||this.isNegativeInf()?(this.setZero(),this):this.m_rn.v===0n?(this.setPositiveInf(),this):(this.m_rd=H(this.m_rn,this.m_rn=this.m_rd),this.m_power=-this.m_power,this)}limitPrecisionThis(t){if(t===0)return this;if(this.isZero())return this.setZero();if(!this.isFinite())return this;this.normalizeThis();let s=Number($(this.m_rn.v));if(s>t){const i=s-t;this.m_rn.v>>=BigInt(s-t),this.m_power+=i}if(s=Number($(this.m_rd.v)),s>t){const i=s-t;this.m_rd.v>>=BigInt(s-t),this.m_power-=i}return this}hiBitIndex(){return Math.max(Number($(this.m_rn.v)),Number($(this.m_rd.v)))}ldexp(t){return this.clone().ldexpThis(t)}ldexpThis(t){return t&&(this.m_bNormalized=!1,this.m_power+=t,this.normalizeThis()),this}LZ(){return!this.isNAN()&&this.m_sign===-1}GZ(){return!this.isNAN()&&this.m_sign===1}LEZ(){return!this.isNAN()&&this.m_sign<=0}GEZ(){return!this.isNAN()&&this.m_sign>=0}toString(){return this.toDouble().toString()}sqr(){return this.clone().sqrThis()}sqrThis(){return this.mulThis(this.clone())}static sqrt(t,s){if(t.m_sign<0n&&Ht("MP_value: sqrt(-1)"),t.isZero())return t.clone();let i=52,n=2220446049250313e-31;for(;i<s;)2*i<=s?(n*=n,i*=2):(n*=2220446049250313e-31,i+=52);i+=52;const r=$(t.m_rn.v),o=$(t.m_rd.v);let h,a=t.m_power+Number(r-o);const u=new M;Math.abs(a)>200?(1&Math.abs(a)&&(a+=1),h=M.constructAssign(t,53).ldexpThis(-a).value(),u.setThis(t).ldexpThis(-a),_(Number.isFinite(h))):(u.setThis(t),h=u.value(),_(Number.isFinite(h)),a=0),h=Math.sqrt(h);const c=M.constructDouble(h),l=M.constructDouble(n);l.mulThis(c).ldexpThis(1);const y=n*h*2,N=c.clone(),b=new M;let f;for(let w=0;w<10;++w){N.mulThis(c),b.setThis(u).subThis(N).absThis();let v=b.value();if(f=1,v<.9)for(;v>y;)v*=v,++f;else f=4;if(b.lte(l))break;for(let C=0;C<f;C++)N.setThis(c).divThis(u).invertThis().addThis(c).ldexpThis(-1).limitPrecisionThis(i),c.setThis(N)}return c.ldexpThis(a/2)}static cubicRoot(t,s){if(t.isZero())return t.clone();let i=52,n=2220446049250313e-31;for(;i<s;)2*i<=s?(n*=n,i*=2):(n*=2220446049250313e-31,i+=52);i+=52;const r=Math.pow(Math.abs(t.value()),1/3),o=M.constructDouble(r),h=o.clone();h.sqrThis().mulDoubleThis(3).mulDoubleThis(n),h.limitPrecisionThis(32),t.LZ()&&o.negateThis();for(let a=0;a<10;++a){const u=o.clone();u.sqrThis().mulThis(o);const c=u.clone();if(c.subThis(t),c.absThis().limitPrecisionThis(32),c.lte(h))break;c.setThis(t),c.ldexpThis(1),c.addThis(u);const l=u.clone();l.ldexpThis(1),l.addThis(t),c.divThis(l),o.mulThis(c),o.limitPrecisionThis(i)}return o}isInTheRangeOfDouble(){return _(0),!1}sign(){return this.m_sign}cosAndSin(t,s){_(0)}static nan(){return _(0),new M}convertToDouble(){if(this.m_bNaN)return Number.NaN;if(this.isZero())return 0;if(this.m_rd.v===0n)return this.m_sign===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;const t=this.m_sign===-1,s=this.m_rn.v<<(this.m_power>=0?BigInt(this.m_power):0n);let i=this.m_rd.v<<(this.m_power<0?BigInt(-this.m_power):0n);const n=s/i;let r=Number(n);if(BigInt(r)!==n)return t?-r:r;let o=s-n*i;if(o){let h=$(i)-1023n;h>0n&&(i>>=h,o<<=52n,o>>=h);let a=Number(o);Number.isFinite(a)||(o>>=52n,a=Number(o),h=0n),h>0n&&(a/=Math.pow(2,52)),r+=a/Number(i)}return t?-r:r}signVal(){return this.m_sign===1?1n:this.m_sign===-1?-1n:0n}opPlusMinus(t,s){const i=Math.min(this.m_power,t.m_power);let n,r;this.m_power>i?(n=BigInt(this.m_power-i),r=0n):(n=0n,r=BigInt(t.m_power-i));const o=this.signVal()*this.m_rn.v*t.m_rd.v<<n,h=t.signVal()*t.m_rn.v*this.m_rd.v<<r;return this.m_rn.v=s?o+h:o-h,this.m_rd.v*=t.m_rd.v,this.m_power=i,this.m_sign=1,this.m_rn.v<0n&&(this.m_sign=-1,this.m_rn.v=-this.m_rn.v),this.m_bNormalized=!1,this.normalizeThis(),this}}M.s_sm=0x8000000000000000n,M.s_em=0x7ff0000000000000n,M.s_fm=0x000fffffffffffffn,M.s_emax=0x7ffn;const Se=M.constructInt32(1),Ze=M.constructInt32(0);function Fe(e,t){return ui(e^t)}function Le(e,t){let s=Ns(e);const i=Ns(t);return s===i?(s-=53-Fe(lt(e),lt(t)),s):s>i?s:i}function Ge(e,t){for(let s=0,i=0,n=e.length;s<n;s+=2,i++)t[i].x=e[s],t[i].y=e[s+1]}function Be(e){const t=new Float64Array(2*e.length);for(let s=0,i=e.length;s<i;++s){const n=s<<1;t[n]=e[s].x,t[n+1]=e[s].y}return t}function ke(e){const t=Rt(p,e.length);for(let s=0,i=e.length;s<i;++s)t[s].setCoords(e[s][0],e[s][1]);return t}class p{static construct(t,s){return new p(t,s)}constructor(t,s){t!==void 0?(this.x=t,this.y=s):this.x=this.y=Number.NaN}clone(){return new p(this.x,this.y)}assign(t){this.setCoordsPoint2D(t)}setCoords(t,s){return this.x=t,this.y=s,this}setCoordsPoint2D(t){this.x=t.x,this.y=t.y}isEqualPoint2D(t,s){return s!==void 0?Math.abs(this.x-t.x)<=s&&Math.abs(this.y-t.y)<=s:this.x===t.x&&this.y===t.y}isEqual(t,s,i){return i!==void 0?Math.abs(this.x-t)<=i&&Math.abs(this.y-s)<=i:this.x===t&&this.y===s}equalsPoint2D(t,s){return this.isEqualPoint2D(t,s)}setSub(t,s){this.x=t.x-s.x,this.y=t.y-s.y}addThis(t){return this.x+=t.x,this.y+=t.y,this}setAdd(t,s){return this.x=t.x+s.x,this.y=t.y+s.y,this}absoluteOther(t){}absolute(){return _(0),this}setNegate(){this.x=-this.x,this.y=-this.y}setNegateOther(t){this.x=-t.x,this.y=-t.y}interpolateThis(t,s){}interpolate(t,s,i){_(0)}scaleAddThis(t,s){this.x=this.x*t+s.x,this.y=this.y*t+s.y}setScaleAdd(t,s,i){this.x=s.x*t+i.x,this.y=s.y*t+i.y}scaleOther(t,s){_(0)}scale(t){this.x*=t,this.y*=t}compare(t){return this.y<t.y?-1:this.y>t.y?1:this.x<t.x?-1:this.x>t.x?1:0}compareX(t){return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0}normalizeOther(t){_(0)}normalize(){const t=this.length();return t?(this.x/=t,this.y/=t):(this.x=1,this.y=0),this}getUnitVector(){return this.clone().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}sqrLength(){return this.x*this.x+this.y*this.y}static averageFast(t,s){return _(0),{}}static average(t,s){const i=new p;if(s===0)return i.setNAN(),i;if(s===1)return i.assign(t[0]),i;const n=new ot(t[0].x),r=new ot(t[0].y);for(let o=1;o<s;o++)n.add(t[o].x),r.add(t[o].y),255&o||(n.normalize(),r.normalize());return i.x=n.getResult()/s,i.y=r.getResult()/s,i}offset(t,s){const i=p.distance(t,s),n=p.construct(this.x,this.y);if(i===0)return p.distance(n,t);const r=s.clone();return r.subThis(t),n.subThis(t),n.crossProduct(r)/i}side(t,s){return t.equals(s)?this.equals(t)?0:1:p.orientationRobust(s,t,this)}static sqrDistance(t,s){const i=t.x-s.x,n=t.y-s.y;return i*i+n*n}static sqrDistanceCoords(t,s,i,n){const r=i-t,o=n-s;return r*r+o*o}static distance(t,s){return Math.sqrt(p.sqrDistance(t,s))}dotProduct(t){return this.x*t.x+this.y*t.y}dotProductAbs(t){return Math.abs(this.x*t.x)+Math.abs(this.y*t.y)}crossProduct(t){return this.x*t.y-this.y*t.x}crossProductAbs(t){return _(0),0}rotateDirect(t,s){const i=this.x*t-this.y*s,n=this.x*s+this.y*t;this.x=i,this.y=n}rotateReverse(t,s){const i=this.x*t+this.y*s,n=-this.x*s+this.y*t;this.x=i,this.y=n}leftPerpendicularThis(){const t=this.x;this.x=-this.y,this.y=t}leftPerpendicularOther(t){const s=t.x;this.x=-t.y,this.y=s}rightPerpendicularThis(){const t=this.x;this.x=this.y,this.y=-t}rightPerpendicularOther(t){const s=t.x;this.x=t.y,this.y=-s}equals(t){return this.x===t.x&&this.y===t.y}notequals(t){return this.x!==t.x||this.y!==t.y}not(){return!this.x&&!this.y}gt(t){return this.y>t.y||this.y===t.y&&this.x>t.x}gte(t){return!this.lt(t)}lt(t){return this.y<t.y||this.y===t.y&&this.x<t.x}lte(t){return!this.gt(t)}subThis(t){return this.x-=t.x,this.y-=t.y,this}divThis(t){return this.x/=t,this.y/=t,this}add(t){return new p(this.x+t.x,this.y+t.y)}sub(t){return new p(this.x-t.x,this.y-t.y)}negateThis(){return this.x=-this.x,this.y=-this.y,this}negate(){return new p(-this.x,-this.y)}mul(t){return new p(this.x*t,this.y*t)}mulThis(t){return this.x*=t,this.y*=t,this}divide(t){return new p(this.x/t,this.y/t)}setNAN(){this.x=this.y=Number.NaN}isNAN(){return Number.isNaN(this.x)||Number.isNaN(this.y)}static getNAN(){return new p(Number.NaN,Number.NaN)}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)}isZero(){return this.x===0&&this.y===0}norm(t){switch(t){case 0:{const s=Math.abs(this.x),i=Math.abs(this.y),n=s-i;return n>=0?s:n<=0?i:Number.NaN}case 1:return Math.abs(this.x)+Math.abs(this.y);case 2:return Math.sqrt(this.x*this.x+this.y*this.y);default:W("norm")}}getQuarter(){return p.getQuarterCoords(this.x,this.y)}static getQuarterCoords(t,s){return t>0?s>=0?1:4:s>0?2:t===0?4:3}static compareVectors(t,s){const i=t.getQuarter(),n=s.getQuarter();return n===i?p.orientationRobustImpl(p.construct(0,0),s,t,!0):i<n?-1:1}static compareVectorsOrigin(t,s,i){const n=s.sub(t),r=i.sub(t),o=n.getQuarter(),h=r.getQuarter();return h===o?p.orientationRobustImpl(t,i,s,!0):o<h?-1:1}static orientationRobust(t,s,i){return p.orientationRobustImpl(t,s,i,!1)}static orientationRobustEx(t,s,i,n){if(t.equals(s)||i.equals(n))return 0;const r=s.x-t.x,o=s.y-t.y,h=n.x-i.x,a=n.y-i.y;{const N=p.getQuarterCoords(r,o)-1,b=p.getQuarterCoords(h,a)-1,f=p.d[N][b];if(f!==0)return f}const u=r*a,c=o*h,l=4*J()*(Math.abs(u)+Math.abs(c)),y=u-c;return Math.abs(y)>=l?y<0?-1:y>0?1:0:p.orientationRobustExMp(t,s,i,n)}static orientationRobustExMp(t,s,i,n){const r=M.constructDouble(s.x),o=M.constructDouble(n.x);r.subThis(M.constructDouble(t.x)),o.subThis(M.constructDouble(i.x));const h=M.constructDouble(s.y),a=M.constructDouble(n.y);return h.subThis(M.constructDouble(t.y)),a.subThis(M.constructDouble(i.y)),r.mulThis(a),h.mulThis(o),r.subThis(h),r.LZ()?-1:r.GZ()?1:0}static orientationNonRobust(t,s,i){const n=s.sub(t).crossProduct(i.sub(t));return n<0?-1:n>0?1:0}static orientationRobustImpl(t,s,i,n){if(s.isEqualPoint2D(t)||i.isEqualPoint2D(t)||s.isEqualPoint2D(i))return 0;const r=s.x-t.x,o=s.y-t.y,h=i.x-t.x,a=i.y-t.y;if(!n){const l=p.getQuarterCoords(r,o)-1,y=p.getQuarterCoords(h,a)-1,N=p.d[l][y];if(N!==0)return N}const u=(Math.abs(r)+Math.abs(o)+Math.abs(h)+Math.abs(a))*(Math.abs(s.x)+Math.abs(s.y)+Math.abs(i.x)+Math.abs(i.y))*8*vt(),c=r*a-o*h;if(Math.abs(c)>u)return c<0?-1:1;if(L(s.x,t.x)&&L(i.y,t.y)&&L(s.y,t.y)&&L(i.x,t.x)&&z(r,a)&&z(o,h)){const l=r*a,y=o*h;if(L(l,y)){const N=l-y;return N<0?-1:N>0?1:0}}return p.orientationRobustMp(t,s,i)}static orientationRobustMp(t,s,i){const n=M.constructDouble(s.x),r=M.constructDouble(i.x);{const a=M.constructDouble(t.x);n.subThis(a),r.subThis(a)}const o=M.constructDouble(i.y),h=M.constructDouble(s.y);{const a=M.constructDouble(t.y);o.subThis(a),h.subThis(a)}return n.mulThis(o),h.mulThis(r),n.subThis(h),n.LZ()?-1:n.GZ()?1:0}static inCircleRobust(t,s,i,n){const r=new R,o=new R;r.set(t.x),r.subThis(n.x),o.set(t.y),o.subThis(n.y);const h=new R,a=new R;h.set(s.x),h.subThis(n.x),a.set(s.y),a.subThis(n.y);const u=new R,c=new R;u.set(i.x),u.subThis(n.x),c.set(i.y),c.subThis(n.y);const l=r.mulE(a).subE(o.mulE(h)),y=h.mulE(c).subE(a.mulE(u)),N=r.mulE(c).subE(o.mulE(u)),b=r.mulE(r).addE(o.mulE(o)),f=h.mulE(h).addE(a.mulE(a)),w=u.mulE(u).addE(c.mulE(c)),v=b.mulE(y).subE(f.mulE(N)).addE(w.mulE(l));if(!v.isFuzzyZero()){const C=v.value();return C<0?-1:C>0?1:0}return p.inCircleRobustMp(t,s,i,n)}static inCircleRobustMp(t,s,i,n){do{if(!L(t.x,n.x)||!L(t.y,n.y)||!L(s.x,n.x)||!L(s.y,n.y)||!L(i.x,n.x)||!L(i.y,n.y))break;const I=t.x-n.x,A=t.y-n.y,D=s.x-n.x,T=s.y-n.y,F=i.x-n.x,G=i.y-n.y;if(!z(I,T)||!z(A,D)||!z(D,G)||!z(T,F)||!z(I,G)||!z(A,F)||!z(I,I)||!z(A,A)||!z(D,D)||!z(T,T)||!z(F,F)||!z(G,G))break;const K=I*T,q=A*D,m=D*G,g=T*F,x=I*G,d=A*F,S=I*I,Z=A*A,zt=D*D,St=T*T,Zt=F*F,Ft=G*G;if(!L(K,q)||!L(m,g)||!L(x,d)||!ht(S,Z)||!ht(zt,St)||!ht(Zt,Ft))break;const Lt=K-q,Gt=m-g,Bt=x-d,kt=S+Z,Ot=zt+St,Ut=Zt+Ft;if(!z(kt,Gt)||!z(Ot,Bt)||!z(Ut,Lt))break;const Qt=kt*Gt,Vt=Ot*Bt,Wt=Ut*Lt;if(!L(Qt,Vt))break;const jt=Qt-Vt;if(!ht(jt,Wt))break;const Yt=jt+Wt;return Yt<0?-1:Yt>0?1:0}while(!1);const r=M.constructDouble(n.x),o=M.constructDouble(n.y),h=M.constructDouble(t.x),a=M.constructDouble(t.y);h.subThis(r),a.subThis(o);const u=M.constructDouble(s.x),c=M.constructDouble(s.y);u.subThis(r),c.subThis(o);const l=M.constructDouble(i.x),y=M.constructDouble(i.y);l.subThis(r),y.subThis(o);const N=h.mul(c).sub(a.mul(u)),b=u.mul(y).sub(c.mul(l)),f=h.mul(y).sub(a.mul(l)),w=h.mul(h).add(a.mul(a)),v=u.mul(u).add(c.mul(c)),C=l.mul(l).add(y.mul(y)),E=w.mul(b).sub(v.mul(f)).add(C.mul(N));return E.LZ()?-1:E.GZ()?1:0}static inCircleRobustMp3Point(t,s,i){const n=M.constructDouble(t.x),r=M.constructDouble(t.y),o=M.constructDouble(s.x),h=M.constructDouble(s.y),a=M.constructDouble(i.x),u=M.constructDouble(i.y),c=a.mul(a).add(u.mul(u)).sub(a.mul(n).add(u.mul(r)).add(a.mul(o)).add(u.mul(h))).add(n.mul(o).add(r.mul(h)));return c.LZ()?-1:c.GZ()?1:0}static inCircleRobust3Point(t,s,i){const n=new R(t.x),r=new R(t.y),o=new R(s.x),h=new R(s.y),a=new R(i.x),u=new R(i.y),c=a.mulE(a).addE(u.mulE(u)).subE(a.mulE(n).addE(u.mulE(r)).addE(a.mulE(o)).addE(u.mulE(h))).addE(n.mulE(o).addE(r.mulE(h)));if(!c.isFuzzyZero()){const l=c.value();return l<0?-1:l>0?1:0}return p.inCircleRobustMp3Point(t,s,i)}static calculateCircleCenterFromThreePoints(t,s,i){if(t.equals(i)||t.equals(s)||i.equals(s))return p.getNAN();const n=Oe(t,s,i);return n.isNAN()?Ue(t,s,i):n}static calculateAngle(t,s){return Math.atan2(t.crossProduct(s),t.dotProduct(s))}static isBisectorRobust(t,s,i){return _(0),!1}static size(){return 2}get 0(){return this.x}get 1(){return this.y}set 0(t){this.x=t}set 1(t){this.y=t}static compareZorder(t,s){const i=p.c_compare_zorder_xx[t.x<0?1:0]|p.c_compare_zorder_yy[t.y<0?1:0],n=p.c_compare_zorder_xx[s.x<0?1:0]|p.c_compare_zorder_yy[s.y<0?1:0];if(i===n){let r=0,o=0;for(let h=0;h<2;++h){const a=Le(t[h],s[h]);a>r&&(r=a,o=h)}return t[o]<s[o]}return i<n}static lerp(t,s,i){const n=new p;return Nt(t,s,i,n),n}static getClosestCoordinate(t,s,i,n=!1){const r=p.getNAN();r.setSub(s,t);const o=r.sqrLength();if(o===0)return .5;if(s.isEqualPoint2D(i))return 1;const h=p.getNAN();h.setSub(i,t);let a=h.dotProduct(r)/o;return n||(a<0?a=0:a>1&&(a=1)),a}static intersectLinesAtOnePoint(t,s,i,n){if(t.equals(s)||i.equals(n))return p.getNAN();const r=s.x-t.x,o=i.x-n.x,h=s.y-t.y,a=i.y-n.y,u=r*a-o*h;if(!u)return p.getNAN();const c=u;if(c===0)return p.getNAN();let l=(i.x-t.x)*a-(i.y-t.y)*o;l/=c;const y=new p;return Nt(t,s,l,y),y.isFinite()?y:p.getNAN()}toString(){return`[${this.x},${this.y}]`}}function Oe(e,t,s){const i=new R(t.x);i.subThis(e.x);const n=new R(t.y);n.subThis(e.y);const r=new R(s.x);r.subThis(e.x);const o=new R(s.y);o.subThis(e.y);const h=i.clone();h.mulThisE(o);let a=n.clone();if(a.mulThisE(r),h.subThisE(a),h.value()===0)return p.getNAN();h.mulThis(2);const u=i.clone();u.mulThisE(i);const c=n.clone();c.mulThisE(n);const l=u.clone();l.addThisE(c);const y=r.clone();y.mulThisE(r);const N=o.clone();N.mulThisE(o);const b=y.clone();b.addThisE(N);const f=n.clone();f.mulThisE(b),a=o.clone(),a.mulThisE(l),f.subThisE(a),f.divThisE(h);const w=i.clone();w.mulThisE(b),a=r.clone(),a.mulThisE(l),w.subThisE(a),w.divThisE(h);const v=p.construct(e.x-f.value(),e.y+w.value()),C=e.sub(v).length(),E=t.sub(v).length(),I=s.sub(v).length(),A=1e-15*(C+Math.abs(e.x)+Math.abs(t.x)+Math.abs(s.x)+Math.abs(e.y)+Math.abs(t.y)+Math.abs(s.y));return Math.abs(C-E)<=A&&Math.abs(C-I)<=A&&f.eps()<A&&w.eps()<A?v:p.getNAN()}function Ue(e,t,s){const i=M.constructDouble(t.x);i.subDoubleThis(e.x);const n=M.constructDouble(t.y);n.subDoubleThis(e.y);const r=M.constructDouble(s.x);r.subDoubleThis(e.x);const o=M.constructDouble(s.y);o.subDoubleThis(e.y);const h=i.clone();h.mulThis(o);let a=n.clone();if(a.mulThis(r),h.subThis(a),h.isZero())return p.getNAN();h.mulDoubleThis(2);const u=i.clone();u.mulThis(i);const c=n.clone();c.mulThis(n);const l=u.clone();l.addThis(c);const y=r.clone();y.mulThis(r);const N=o.clone();N.mulThis(o);const b=y.clone();b.addThis(N);const f=n.clone();f.mulThis(b),a=o.clone(),a.mulThis(l),f.subThis(a),f.divThis(h);const w=i.clone();return w.mulThis(b),a=r.clone(),a.mulThis(l),w.subThis(a),w.divThis(h),p.construct(e.x-f.value(),e.y+w.value())}p.dimensions=2,p.d=[[0,1,0,-1],[-1,0,1,0],[0,-1,0,1],[1,0,-1,0]],p.c_compare_zorder_xx=[2,0],p.c_compare_zorder_yy=[1,0];class P{constructor(t,s,i){if(t instanceof P)return this.data=t.data,this.N=t.N,this.M=t.M,t.data=null,t.N=0,void(t.M=0);this.data=t,this.N=s,this.M=i}assignCopy(t){return this===t||(_(this.N*this.M==t.N*t.M),this.data.set(t.data),this.N=t.N,this.M=t.M),this}setZero(){return this.data?.fill(0),this}setIdentity(){for(let t=0;t<this.N;t++)for(let s=0;s<this.M;s++)this.setRowCol(t,s,t===s?1:0);return this}rows(){return this.N}cols(){return this.M}row(t){return _(0),{}}set(t,s){return this.data[t]=s,this}setRowCol(t,s,i){return this.data[t*this.M+s]=i,this}at(t){return this.data[t]}atRowCol(t,s){return this.data[t*this.M+s]}mulScalar(t,s){_(0)}mul(t,s){if(_(this.M===t.rows()),_(this.N===s.rows()),_(t.cols()===s.cols()),s===this){const n=new Float64Array(this.N*this.M),r=new P(n,this.N,this.M);return this.mul(t,r),void s.assignCopy(r)}if(s===t){const n=new Float64Array(t.N*t.M),r=new P(n,t.N,t.M);return this.mul(t,r),void s.assignCopy(r)}const i=t.cols();for(let n=0;n<this.N;n++)for(let r=0;r<i;r++){let o=0;for(let h=0;h<this.M;h++)o+=this.atRowCol(n,h)*t.atRowCol(h,r);s.setRowCol(n,r,o)}}mulTranspose(t,s){if(_(this.M===t.cols()),_(this.N===s.rows()),_(t.rows()===s.cols()),s===this){const n=new Float64Array(this.N*this.M),r=new P(n,this.N,this.M);return this.mulTranspose(t,r),void s.assignCopy(r)}if(s===t){const n=new Float64Array(t.N*t.M),r=new P(n,t.N,t.M);return this.mulTranspose(t,r),void s.assignCopy(r)}const i=t.rows();for(let n=0;n<this.N;n++)for(let r=0;r<i;r++){let o=0;for(let h=0;h<this.M;h++)o+=this.atRowCol(n,h)*t.atRowCol(r,h);s.setRowCol(n,r,o)}}mulLeft(t,s){_(0)}mulLeftTranspose(t,s){_(0)}mulDiag(t,s){if(_(this.M===t.N*t.M),_(this.N===s.rows()),_(this.M===s.cols()),s===this){const n=new Float64Array(this.N*this.M),r=new P(n,this.N,this.M);return this.mulDiag(t,r),void s.assignCopy(r)}const i=this.M;for(let n=0;n<this.N;n++)for(let r=0;r<i;r++)s.setRowCol(n,r,this.atRowCol(n,r)*t.at(r))}transposeInPlace(){if(this.N===this.M){for(let i=0;i<this.N;i++)for(let n=i+1;n<this.M;n++){const r=this.atRowCol(i,n);this.setRowCol(i,n,this.atRowCol(n,i)),this.setRowCol(n,i,r)}return this}const t=new Float64Array(this.N*this.M),s=new P(t,this.N,this.M);return s.assignCopy(this),this.M=H(this.N,this.N=this.M),s.transpose(this),this}transpose(t){if(this!==t){P.checkDims(t,this.M,this.N);for(let s=0;s<this.N;s++)for(let i=0;i<this.M;i++)t.setRowCol(i,s,this.atRowCol(s,i))}else t.transposeInPlace()}add(t,s){}svd(t,s,i,n=!1){if(P.checkDims(t,this.N,this.M),P.checkDims(s,this.M,1),P.checkDims(i,this.M,this.M),n){if(_(this.N===this.M),!this.symmetricEigen(s,i))return!1;for(let m=0;m<this.M;++m)s.at(m)<0&&s.set(m,0);return t.assignCopy(i),!0}let r,o,h,a,u,c,l,y=0,N=0,b=0,f=0,w=0;const v=this.M,C=this.N;t.assignCopy(this);const E=new Float64Array(v),I=new P(E,v,1),A=(m,g)=>g>=0?Math.abs(m):-Math.abs(m),D=(m,g)=>{if((m=Math.abs(m))>(g=Math.abs(g))){const x=g/m;return m*Math.sqrt(x*x+1)}if(g>0){const x=m/g;return g*Math.sqrt(x*x+1)}return 0};for(let m=0;m<v;m++){if(y=m+1,I.set(m,f*b),b=a=f=0,m<C){for(let x=m;x<C;x++)f+=Math.abs(t.atRowCol(x,m));if(f){for(let x=m;x<C;x++)t.setRowCol(x,m,t.atRowCol(x,m)/f),a+=t.atRowCol(x,m)*t.atRowCol(x,m);o=t.atRowCol(m,m),b=-A(Math.sqrt(a),o),h=o*b-a,t.setRowCol(m,m,o-b);for(let x=y;x<v;x++){a=0;for(let d=m;d<C;d++)a+=t.atRowCol(d,m)*t.atRowCol(d,x);o=a/h;for(let d=m;d<C;d++)t.setRowCol(d,x,t.atRowCol(d,x)+o*t.atRowCol(d,m))}for(let x=m;x<C;x++)t.setRowCol(x,m,t.atRowCol(x,m)*f)}}if(s.set(m,f*b),b=a=f=0,m<C&&m!==v-1){for(let x=y;x<v;x++)f+=Math.abs(t.atRowCol(m,x));if(f){for(let x=y;x<v;x++)t.setRowCol(m,x,t.atRowCol(m,x)/f),a+=t.atRowCol(m,x)*t.atRowCol(m,x);o=t.atRowCol(m,y),b=-A(Math.sqrt(a),o),h=o*b-a,t.setRowCol(m,y,o-b);for(let x=y;x<v;x++)I.set(x,t.atRowCol(m,x)/h);for(let x=y;x<C;x++){a=0;for(let d=y;d<v;d++)a+=t.atRowCol(x,d)*t.atRowCol(m,d);for(let d=y;d<v;d++)t.setRowCol(x,d,t.atRowCol(x,d)+a*I.at(d))}for(let x=y;x<v;x++)t.setRowCol(m,x,t.atRowCol(m,x)*f)}}const g=Math.abs(s.at(m))+Math.abs(I.at(m));w=g>w?g:w}for(let m=v-1;m>=0;m--){if(m<v-1){if(b){for(let g=y;g<v;g++)i.setRowCol(g,m,t.atRowCol(m,g)/t.atRowCol(m,y)/b);for(let g=y;g<v;g++){a=0;for(let x=y;x<v;x++)a+=t.atRowCol(m,x)*i.atRowCol(x,g);for(let x=y;x<v;x++)i.setRowCol(x,g,i.atRowCol(x,g)+a*i.atRowCol(x,m))}}for(let g=y;g<v;g++)i.setRowCol(m,g,0),i.setRowCol(g,m,0)}i.setRowCol(m,m,1),b=I.at(m),y=m}for(let m=(C<v?C:v)-1;m>=0;m--){y=m+1,b=s.at(m);for(let g=y;g<v;g++)t.setRowCol(m,g,0);if(b){b=1/b;for(let g=y;g<v;g++){a=0;for(let x=y;x<C;x++)a+=t.atRowCol(x,m)*t.atRowCol(x,g);o=a/t.atRowCol(m,m)*b;for(let x=m;x<C;x++)t.setRowCol(x,g,t.atRowCol(x,g)+o*t.atRowCol(x,m))}for(let g=m;g<C;g++)t.setRowCol(g,m,t.atRowCol(g,m)*b)}else for(let g=m;g<C;g++)t.setRowCol(g,m,0);t.setRowCol(m,m,t.atRowCol(m,m)+1)}for(let m=v-1;m>=0;m--)for(let g=1;;g++){let x=1;for(y=m;y>=0;y--){if(N=y-1,Math.abs(I.at(y))+w===w){x=0;break}if(Math.abs(s.at(N))+w===w)break}if(x){r=0,a=1;for(let d=y;d<=m&&(o=a*I.at(d),I.set(d,I.at(d)*r),Math.abs(o)+w!==w);d++){b=s.at(d),h=D(o,b),s.set(d,h),h=1/h,r=b*h,a=-o*h;for(let S=0;S<C;S++)c=t.atRowCol(S,N),l=t.atRowCol(S,d),t.setRowCol(S,N,c*r+l*a),t.setRowCol(S,d,l*r-c*a)}}if(l=s.at(m),y===m){if(l<0){s.set(m,-l);for(let d=0;d<v;d++)i.setRowCol(d,m,-i.atRowCol(d,m))}break}if(g===100)return!1;u=s.at(y),N=m-1,c=s.at(N),b=I.at(N),h=I.at(m),o=((c-l)*(c+l)+(b-h)*(b+h))/(2*h*c),b=D(o,1),o=((u-l)*(u+l)+h*(c/(o+A(b,o))-h))/u,r=a=1;for(let d=y;d<=N;d++){const S=d+1;b=I.at(S),c=s.at(S),h=a*b,b*=r,l=D(o,h),I.set(d,l),r=o/l,a=h/l,o=u*r+b*a,b=b*r-u*a,h=c*a,c*=r;for(let Z=0;Z<v;Z++)u=i.atRowCol(Z,d),l=i.atRowCol(Z,S),i.setRowCol(Z,d,u*r+l*a),i.setRowCol(Z,S,l*r-u*a);l=D(o,h),s.set(d,l),l&&(l=1/l,r=o*l,a=h*l),o=r*b+a*c,u=r*c-a*b;for(let Z=0;Z<C;Z++)c=t.atRowCol(Z,d),l=t.atRowCol(Z,S),t.setRowCol(Z,d,c*r+l*a),t.setRowCol(Z,S,l*r-c*a)}I.set(y,0),I.set(m,o),s.set(m,u)}const T=new Float64Array(this.N),F=new Float64Array(this.M),G=new P(T,this.N,1),K=new P(F,this.M,1);let q=1;do q*=3,q++;while(q<=this.M);do{q/=3,q=Math.trunc(q);for(let m=q;m<this.M;m++){const g=s.at(m);for(let d=0;d<this.N;d++)G.set(d,t.atRowCol(d,m));for(let d=0;d<this.M;d++)K.set(d,i.atRowCol(d,m));let x=m;for(;s.at(x-q)<g;){s.set(x,s.at(x-q));for(let d=0;d<this.N;d++)t.setRowCol(d,x,t.atRowCol(d,x-q));for(let d=0;d<this.M;d++)i.setRowCol(d,x,i.atRowCol(d,x-q));if(x-=q,x<q)break}s.set(x,g);for(let d=0;d<this.N;d++)t.setRowCol(d,x,G.at(d));for(let d=0;d<this.M;d++)i.setRowCol(d,x,K.at(d))}}while(q>1);for(let m=0;m<this.M;m++){let g=0;for(let x=0;x<this.N;x++)t.atRowCol(x,m)<0&&g++;for(let x=0;x<this.M;x++)i.atRowCol(x,m)<0&&g++;if(g>Math.trunc((this.N+this.M)/2)){for(let x=0;x<this.N;x++)t.setRowCol(x,m,-t.atRowCol(x,m));for(let x=0;x<this.M;x++)i.setRowCol(x,m,-i.atRowCol(x,m))}}return!0}isSymmetric(){if(this.N!==this.M)return!1;for(let t=0;t<this.N;t++)for(let s=t+1;s<this.M;s++)if(this.atRowCol(t,s)!==this.atRowCol(s,t))return!1;return!0}isZero(){return _(0),!1}isIdentity(){return _(0),!1}equals(t,s){if(s!==void 0&&_(0),this.N!==t.N||this.M!==t.M)return!1;for(let i=0;i<this.N*this.M;i++)if(this.data[i]!==t.data[i])return!1;return!0}maxElement(){return _(0),0}minElement(){return _(0),0}determinant(){if(_(this.N===this.M),this.N===1)return this.data[0];if(this.N===2)return this.data[0]*this.data[3]-this.data[1]*this.data[2];if(this.N===3){const r=this;return r.atRowCol(0,0)*(r.atRowCol(1,1)*r.atRowCol(2,2)-r.atRowCol(1,2)*r.atRowCol(2,1))-r.atRowCol(0,1)*(r.atRowCol(1,0)*r.atRowCol(2,2)-r.atRowCol(2,0)*r.atRowCol(1,2))+r.atRowCol(0,2)*(r.atRowCol(1,0)*r.atRowCol(2,1)-r.atRowCol(1,1)*r.atRowCol(2,0))}const t=new Float64Array(this.N*this.N),s=new P(t,this.N,this.N),i=new Float64Array(this.N);if(!this.luDecomposition(s,i))return 0;let n=1;for(let r=0;r<this.N;r++)n*=s.atRowCol(r,r),i[r]!==r&&(n=-n);return n}submatrix(t,s,i){_(0)}inverse(t){_(0)}pseudoInverse(t,s=!1,i=2220446049250313e-31){if(t.setZero(),this.N===1&&this.M===1)return this.atRowCol(0,0)!==0?t.setRowCol(0,0,1/this.atRowCol(0,0)):t.setRowCol(0,0,0),!0;if(this.N===2&&this.M===2){const y=this.atRowCol(0,0)*this.atRowCol(1,1)-this.atRowCol(0,1)*this.atRowCol(1,0),N=1e-5*(Math.abs(this.atRowCol(0,0)*this.atRowCol(1,1))+Math.abs(this.atRowCol(0,1)*this.atRowCol(1,0)));if(Math.abs(y)>N)return t.setRowCol(0,0,this.atRowCol(1,1)/y),t.setRowCol(0,1,-this.atRowCol(0,1)/y),t.setRowCol(1,0,-this.atRowCol(1,0)/y),t.setRowCol(1,1,this.atRowCol(0,0)/y),!0}const n=new Float64Array(this.N*this.M),r=new P(n,this.N,this.M),o=new Float64Array(this.M),h=new P(o,this.M,1),a=new Float64Array(this.M*this.M),u=new P(a,this.M,this.M);if(!this.svd(r,h,u,s))return!1;const c=Math.max(this.N,this.M),l=i*Math.abs(h.at(0))*c;for(let y=0;y<this.M;y++)h.at(y)>l?h.set(y,1/h.at(y)):h.set(y,0);return u.mulDiag(h,t),t.mulTranspose(r,t),!0}luDecomposition(t,s){return _(0),!1}symmetricEigen(t,s){_(this.rows()===this.cols()),_(this.rows()===t.rows()),_(s.rows()===s.cols()&&s.rows()===this.rows()),_(this.isSymmetric());const i=new Float64Array(this.N*this.M),n=new P(i,this.N,this.M);n.assignCopy(this);const r=100/Number.EPSILON,o=this.rows(),h=new Float64Array(o),a=new Float64Array(o),u=new P(h,o,1),c=new P(a,o,1);for(let y=0;y<o;y++)u.set(y,n.atRowCol(y,y)),t.set(y,n.atRowCol(y,y)),c.set(y,0);s.setIdentity();const l=()=>{const y=u;s.transposeInPlace();let N=1;do N*=3,N++;while(N<=o);do{N/=3,N=Math.trunc(N);for(let b=N;b<o;b++){const f=t.at(b),w=Math.abs(f);for(let C=0;C<this.M;C++)y.set(C,s.atRowCol(C,b));let v=b;for(;Math.abs(t.at(v-N))<w;){t.set(v,t.at(v-N));for(let C=0;C<this.M;C++)s.setRowCol(C,v,s.atRowCol(C,v-N));if(v-=N,v<N)break}if(v!==b){t.set(v,f);for(let C=0;C<this.M;C++)s.setRowCol(C,v,y.at(C))}}}while(N>1)};for(let y=1;;y++){let N=0;for(let f=1;f<o;f++)for(let w=0;w<f;w++)N+=Math.abs(n.atRowCol(f,w));if(N===0)return l(),!0;const b=y<4?.2*N/(o*o):0;for(let f=0;f<o;f++)for(let w=f+1;w<o;w++){let v=r*Math.abs(n.atRowCol(w,f));if(y>4&&v<=Math.abs(t.at(f))&&v<=Math.abs(t.at(w)))n.setRowCol(w,f,0);else if(Math.abs(n.atRowCol(w,f))>b){let C,E=t.at(w)-t.at(f);if(v<Math.abs(E))C=n.atRowCol(w,f)/E;else{const F=.5*E/n.atRowCol(w,f);C=1/(Math.abs(F)+Math.sqrt(1+F*F)),F<0&&(C=-C)}const I=1/Math.sqrt(1+C*C),A=C*I,D=A/(1+I);E=C*n.atRowCol(w,f),c.set(f,c.at(f)-E),c.set(w,c.at(w)+E),t.set(f,t.at(f)-E),t.set(w,t.at(w)+E),n.setRowCol(w,f,0);let T=0;for(;T<f;T++)v=n.atRowCol(f,T),E=n.atRowCol(w,T),n.setRowCol(f,T,v-A*(E+v*D)),n.setRowCol(w,T,E+A*(v-E*D));for(T++;T<w;T++)v=n.atRowCol(T,f),E=n.atRowCol(w,T),n.setRowCol(T,f,v-A*(E+v*D)),n.setRowCol(w,T,E+A*(v-E*D));for(T++;T<o;T++)v=n.atRowCol(T,f),E=n.atRowCol(T,w),n.setRowCol(T,f,v-A*(E+v*D)),n.setRowCol(T,w,E+A*(v-E*D));for(T=0;T<o;T++)v=s.atRowCol(f,T),E=s.atRowCol(w,T),s.setRowCol(f,T,v-A*(E+v*D)),s.setRowCol(w,T,E+A*(v-E*D))}}for(let f=0;f<o;f++)u.set(f,u.at(f)+c.at(f)),t.set(f,u.at(f)),c.set(f,0)}}static checkDims(t,s,i){_(t.rows()===s&&t.cols()===i)}}class U extends P{constructor(t){if(t.copy){const i=new Float64Array(t.copy.N*t.copy.M);return super(i,t.copy.N,t.copy.M),this.buffer=i,void this.assignCopy(t.copy)}const s=new Float64Array(t.NN*t.MM);super(s,t.NN,t.MM),this.buffer=s,t.initializerList&&j(this.buffer,t.initializerList,0,0,t.initializerList.length)}assignCopy(t){return this===t||super.assignCopy(t),this}}class k{constructor(t){this.m_TransformationType=1,t===void 0?this.setIdentity():t instanceof k?this.set(t):this.setScale(t)}set(t){return this.xx=t.xx,this.xy=t.xy,this.xd=t.xd,this.yx=t.yx,this.yy=t.yy,this.yd=t.yd,this}clone(){return new k().set(this)}setZero(){this.xx=0,this.yy=0,this.xy=0,this.yx=0,this.xd=0,this.yd=0}isEqual(t){return this===t||this.xx===t.xx&&this.xy===t.xy&&this.xd===t.xd&&this.yx===t.yx&&this.yy===t.yy&&this.yd===t.yd}transformInPlace(t){const s=this.xx*t.x+this.xy*t.y+this.xd,i=this.yx*t.x+this.yy*t.y+this.yd;t.x=s,t.y=i}transform(t){const s=t.clone();return this.transformInPlace(s),s}queryTransform(t,s){const i=this.xx*t.x+this.xy*t.y+this.xd,n=this.yx*t.x+this.yy*t.y+this.yd;s.setCoords(i,n)}transformEnvInPlace(t){if(t.isEmpty())return;const s=Rt(p,4);t.queryCorners(s),this.transformPoints2D(s,4,s),t.setFromPoints(s,4)}queryTransformEnv(t,s){_(0)}transformPoints2D(t,s,i){for(let n=0;n<s;++n)this.queryTransform(t[n],i[n])}transformInterleavedPoints(t,s,i){s*=2;const n=p.getNAN();for(let r=0;r<s;r+=2)n.x=t[r],n.y=t[r+1],this.transformInPlace(n),i[r]=n.x,i[r+1]=n.y}multiply(t){return k.st_multiply(this,t,this),this}mulLeft(t){return _(0),this}static st_multiply(t,s,i){const n=t.xx*s.xx+t.yx*s.xy,r=t.xy*s.xx+t.yy*s.xy,o=t.xd*s.xx+t.yd*s.xy+s.xd,h=t.xx*s.yx+t.yx*s.yy,a=t.xy*s.yx+t.yy*s.yy,u=t.xd*s.yx+t.yd*s.yy+s.yd;i.xx=n,i.xy=r,i.xd=o,i.yx=h,i.yy=a,i.yd=u}getCoefficients(t){_(t.length>=6),t[0]=this.xx,t[1]=this.xy,t[2]=this.xd,t[3]=this.yx,t[4]=this.yy,t[5]=this.yd}setCoefficients(t){_(t.length>=6),this.xx=t[0],this.xy=t[1],this.xd=t[2],this.yx=t[3],this.yy=t[4],this.yd=t[5]}copyTo(t){_(0)}initializeFromRect(t,s){t.isEmpty()||s.isEmpty()||!t.width()||!t.height()?this.setZero():(this.xy=this.yx=0,this.xx=s.width()/t.width(),this.yy=s.height()/t.height(),this.xd=s.xmin-t.xmin*this.xx,this.yd=s.ymin-t.ymin*this.yy)}initializeFromRectIsotropic(t,s){if(t.isEmpty()||!t.width()||!t.height()||s.isEmpty())this.setZero();else{this.yx=0,this.xy=0,this.xx=s.width()/t.width(),this.yy=s.height()/t.height(),this.xx>this.yy?this.xx=this.yy:this.yy=this.xx;const i=s.getCenter(),n=t.getCenter();this.xd=i.x-n.x*this.xx,this.yd=i.y-n.y*this.yy}}initializeFromTwoPointsArray(t,s){if(t[0].equals(s[0])&&t[1].equals(s[1]))return void this.setIdentity();if(t[0].equals(t[1])){if(s[0].equals(s[1]))return void this.setShift(s[0].sub(t[0]));W("")}if(!t[0].equals(t[1])&&s[0].equals(s[1]))return this.setZero(),void this.shift(s[0]);this.setShiftCoords(-t[0].x,-t[0].y);const i=p.distance(t[0],t[1]),n=p.distance(s[0],s[1]),r=n/i;this.scale(r,r);const o=t[1].sub(t[0]);o.divThis(i);const h=s[1].sub(s[0]);h.divThis(n);const a=o.crossProduct(h),u=o.dotProduct(h);this.rotate(u,a),this.shiftCoords(s[0].x,s[0].y)}initializeFromTwoPoints(t,s,i,n){const r=[t,s],o=[i,n];this.initializeFromTwoPointsArray(r,o)}transformSizeInPlace(t){_(0)}transformSize(t,s){_(0)}transformTol(t){return _(0),0}transformWithoutTranslateArray(t,s,i){for(let n=0;n<s;++n)this.transformWithoutTranslate(t[n],i[n])}transformWithoutTranslateInPlace(t){const s=this.xx*t.x+this.xy*t.y,i=this.yx*t.x+this.yy*t.y;t.setCoords(s,i)}transformWithoutTranslate(t,s){const i=this.xx*t.x+this.xy*t.y,n=this.yx*t.x+this.yy*t.y;s.setCoords(i,n)}setIdentity(){this.xx=1,this.xy=0,this.xd=0,this.yx=0,this.yy=1,this.yd=0}isIdentity(){return!(this.xx!==1||this.yy!==1||this.xy||this.xd||this.yx||this.yd)}isIdentityTol(t){const s=t*t;return!(O(this.xd)+O(this.yd)>s)&&!(O(this.xy+this.xd)+O(this.yy+this.yd-1)>s)&&!(O(this.xx+this.xd-1)+O(this.yx+this.yd)>s)}isReflective(){return this.xx*this.yy-this.yx*this.xy<0}isUniform(t){const s=this.xx*this.xx+this.yx*this.yx,i=this.xy*this.xy+this.yy*this.yy,n=(s+i)*t;return Math.abs(s-i)<=n&&Math.abs(this.xx*this.xy+this.yx*this.yy)<=n}isUniformNoRotation(){return this.xx!==0&&Math.abs(this.xx)===Math.abs(this.yy)&&this.xy===0&&this.yx===0}isTranslate(){return this.xx===1&&this.yy===1&&!this.xy&&!this.yx}isTranslateTol(t){const s=new p;return s.setCoords(0,1),this.transformWithoutTranslateInPlace(s),s.y-=1,!(s.sqrLength()>t*t)&&(s.setCoords(1,0),this.transformWithoutTranslateInPlace(s),s.x-=1,s.sqrLength()<=t*t)}isOrthonormal(t){const s=new k;return s.xx=this.xx*this.xx+this.xy*this.xy,s.xy=this.xx*this.yx+this.xy*this.yy,s.yx=this.yx*this.xx+this.yy*this.xy,s.yy=this.yx*this.yx+this.yy*this.yy,s.xd=0,s.yd=0,s.isIdentityTol(t)}isDegenerate(t){return Math.abs(this.xx*this.yy-this.yx*this.xy)<=2*t*(Math.abs(this.xx*this.yy)+Math.abs(this.yx*this.xy))}isZero(){return this.xx===0&&this.yy===0&&this.xy===0&&this.yx===0&&this.xd===0&&this.yd===0}isScaleAndTranslateTol(t){return this.xy*this.xy+this.yx*this.yx<=(this.xx*this.xx+this.yy*this.yy)*t}setTranslate(t,s){return this.xx=1,this.xy=0,this.xd=t,this.yx=0,this.yy=1,this.yd=s,this}setShiftCoords(t,s){return this.xx=1,this.xy=0,this.xd=t,this.yx=0,this.yy=1,this.yd=s,this}setShift(t){return this.xx=1,this.xy=0,this.xd=t.x,this.yx=0,this.yy=1,this.yd=t.y,this}setScaleCoords(t,s){return this.xx=t,this.xy=0,this.xd=0,this.yx=0,this.yy=s,this.yd=0,this}setScale(t){return this.setScaleCoords(t,t),this}setFlipX(t,s){return this.xx=-1,this.xy=0,this.xd=t+s,this.yx=0,this.yy=1,this.yd=0,this}setFlipY(t,s){return this.xx=1,this.xy=0,this.xd=0,this.yx=0,this.yy=-1,this.yd=t+s,this}setShear(t,s){return this.xx=1,this.xy=t,this.xd=0,this.yx=s,this.yy=1,this.yd=0,this}scale(t,s){return this.xx*=t,this.xy*=t,this.xd*=t,this.yx*=s,this.yy*=s,this.yd*=s,this}setRotateAngle(t){return this.setRotate(Math.cos(t),Math.sin(t))}setRotate(t,s){return this.xx=t,this.xy=-s,this.xd=0,this.yx=s,this.yy=t,this.yd=0,this}setRotateAngleAbout(t,s){return this.setRotateAbout(Math.cos(t),Math.sin(t),s)}setRotateAbout(t,s,i){return this.setTranslate(-i.x,-i.y),this.rotate(t,s),this.translate(i.x,i.y)}setSwapCoordinates(){return this.xx=0,this.xy=1,this.xd=0,this.yx=1,this.yy=0,this.yd=0,this}setRotateCw90(){return this.xx=0,this.xy=1,this.xd=0,this.yx=-1,this.yy=0,this.yd=0,this}setRotateCcw90(){return this.xx=0,this.xy=-1,this.xd=0,this.yx=1,this.yy=0,this.yd=0,this}shiftCoords(t,s){return this.xd+=t,this.yd+=s,this}shift(t){return this.xd+=t.x,this.yd+=t.y,this}translate(t,s){return this.xd+=t,this.yd+=s,this}flipX(t,s){return this.xx=-this.xx,this.xy=-this.xy,this.xd=t+s-this.xd,this}flipY(t,s){return this.yx=-this.yx,this.yy=-this.yy,this.yd=t+s-this.yd,this}shear(t,s){const i=new k;return i.setShear(t,s),this.multiply(i)}rotateAngle(t){const s=new k;return s.setRotateAngle(t),this.multiply(s)}rotate(t,s){const i=new k;return i.setRotate(t,s),this.multiply(i)}rotateAbout(t,s,i){return this.translate(-i.x,-i.y),this.rotate(t,s),this.translate(i.x,i.y)}rotateAngleAbout(t,s){return this.rotateAbout(Math.cos(t),Math.sin(t),s)}setInvert(t){return this.set(t),this.invertThis()}invertThis(){let t=this.xx*this.yy-this.xy*this.yx;if(t===0)return this.setZero(),this;t=1/t;const s=(this.xy*this.yd-this.xd*this.yy)*t,i=(this.xd*this.yx-this.xx*this.yd)*t,n=this.yy*t,r=-this.xy*t,o=-this.yx*t,h=this.xx*t;return this.xd=s,this.yd=i,this.xx=n,this.yy=h,this.xy=r,this.yx=o,this}invertPrecise(t){return this.set(t),this.invertPreciseThis()}invertPreciseThis(){const t=M.constructDouble(this.xy),s=M.constructDouble(this.xx),i=s.mulDouble(this.yy).sub(t.mulDouble(this.yx));if(i.isZero())return this.setZero(),this;const n=i.clone();n.invertThis();const r=M.constructDouble(this.xd),o=t.mulDouble(this.yd).sub(r.mulDouble(this.yy)).mul(n).toDouble(),h=r.mulDouble(this.yx).sub(s.mulDouble(this.yd)).mul(n).toDouble(),a=n.mulDouble(this.yy).toDouble(),u=n.mulDouble(-this.xy).toDouble(),c=n.mulDouble(-this.yx).toDouble(),l=n.mulDouble(this.xx).toDouble();return this.xd=o,this.yd=h,this.xx=a,this.yy=l,this.xy=u,this.yx=c,this}extractScaleTransform(t,s){const i=Math.sqrt(this.xx*this.xx+this.xy*this.xy),n=Math.sqrt(this.yx*this.yx+this.yy*this.yy);s.setScaleCoords(1/i,1/n),s.multiply(this),t.setScaleCoords(i,n)}setFromTwoTriangles(t,s){let i=!0;for(let c=0;c<3;++c)i=i&&t[c].equals(s[c]);if(i)return this.setIdentity(),!0;const n=new p;n.setSub(t[0],t[1]);const r=new p;r.setSub(t[0],t[2]);const o=new p;o.setSub(s[0],s[1]);const h=new p;h.setSub(s[0],s[2]);const a=4*Number.EPSILON*(Math.abs(n.x*r.y)+Math.abs(r.x*n.y));let u=n.x*r.y-n.y*r.x;return Math.abs(u)>a?(u=1/u,this.xx=(o.x*r.y-n.y*h.x)*u,this.xy=(n.x*h.x-o.x*r.x)*u,this.yx=(o.y*r.y-n.y*h.y)*u,this.yy=(n.x*h.y-o.y*r.x)*u,this.xd=s[0].x-(this.xx*t[0].x+this.xy*t[0].y),this.yd=s[0].y-(this.yx*t[0].x+this.yy*t[0].y),!0):(this.setZero(),!1)}initializeFromControlPoints(t,s,i,n,r=null){return s===0?(this.setIdentity(),void(r&&r.setIdentity())):s===1?(this.setShift(n[0].sub(i[0])),void(r&&r.setShift(i[0].sub(n[0])))):(s<3&&(t=1),void(t===4&&s>2?Qe(this,s,i,n,r):Ve(t,this,s,i,n,r)))}calculateErrors(t,s,i,n){_(t>0&&s!==null&&i!==null);let r=0;for(let o=0;o<t;++o){const h=this.transform(s[o]),a=p.sqrDistance(i[o],h);r+=a,n&&(n[o]=Math.sqrt(a))}return Math.sqrt(r/t)}}const nt=[43,11,41,9,61];function qt(e,t){_(!(t.rows()!==2&&t.rows()!==3||t.cols()!==2&&t.rows()!==3)),e.xx=t.atRowCol(0,0),e.xy=t.atRowCol(0,1),e.yx=t.atRowCol(1,0),e.yy=t.atRowCol(1,1),t.cols()===3?(e.xd=t.atRowCol(0,2),e.yd=t.atRowCol(1,2)):(e.xd=0,e.yd=0)}function Qe(e,t,s,i,n){const r=p.average(s,t),o=p.average(i,t),h=new U({NN:2,MM:2});h.setZero();const a=new U({NN:2,MM:2});a.setZero();for(let l=0;l<t;++l)h.setRowCol(0,0,h.atRowCol(0,0)+(s[l].x-r.x)*(s[l].x-r.x)),h.setRowCol(0,1,h.atRowCol(0,1)+(s[l].x-r.x)*(s[l].y-r.y)),h.setRowCol(1,1,h.atRowCol(1,1)+(s[l].y-r.y)*(s[l].y-r.y)),a.setRowCol(0,0,a.atRowCol(0,0)+(i[l].x-o.x)*(s[l].x-r.x)),a.setRowCol(0,1,a.atRowCol(0,1)+(i[l].x-o.x)*(s[l].y-r.y)),a.setRowCol(1,0,a.atRowCol(1,0)+(i[l].y-o.y)*(s[l].x-r.x)),a.setRowCol(1,1,a.atRowCol(1,1)+(i[l].y-o.y)*(s[l].y-r.y));h.setRowCol(1,0,h.atRowCol(0,1));const u=new U({NN:2,MM:2});h.pseudoInverse(u,!0)||ft("Failed to compute pseudo inverse"),a.mul(u,a),qt(e,a);const c=r.clone();e.transformInPlace(c),e.xd=o.x-c.x,e.yd=o.y-c.y,n&&(a.pseudoInverse(u,!1)||ft("Failed to compute pseudo inverse"),qt(n,u),n.transformInPlace(o),n.xd=r.x-o.x,n.yd=r.y-o.y)}function Ve(e,t,s,i,n,r){_(e===1||e===0||e===2||e===3),t.setIdentity();const o=p.average(i,s),h=p.average(n,s);if(_(e<nt.length&&e>0),8&nt[e]){const u=new U({NN:2,MM:2});u.setZero();for(let w=0;w<s;++w)u.setRowCol(0,0,u.atRowCol(0,0)+(n[w].x-h.x)*(i[w].x-o.x)),u.setRowCol(1,0,u.atRowCol(1,0)+(n[w].x-h.x)*(i[w].y-o.y)),u.setRowCol(0,1,u.atRowCol(0,1)+(n[w].y-h.y)*(i[w].x-o.x)),u.setRowCol(1,1,u.atRowCol(1,1)+(n[w].y-h.y)*(i[w].y-o.y));const c=new U({NN:2,MM:2}),l=new U({NN:2,MM:1}),y=new U({NN:2,MM:2});u.svd(c,l,y)||ft("Failed to compute svd");const N=new U({NN:2,MM:2});c.transpose(N);const b=new U({NN:2,MM:2});y.mul(N,b),!(32&nt[e])&&b.determinant()<0&&(N.setRowCol(1,0,-N.atRowCol(1,0)),N.setRowCol(1,1,-N.atRowCol(1,1)),y.mul(N,b));const f=new k;qt(f,b),t.set(f)}if(2&nt[e]){let u=0,c=0;for(let l=0;l<s;++l){const y=i[l].sub(o);u+=y.sqrLength(),t.transformInPlace(y),c+=y.dotProduct(n[l].sub(h))}if(u===0)c===0?t.setIdentity():t.setZero();else{const l=c/u;t.scale(l,l)}}else _(!(4&nt[e]));const a=o.clone();t.transformInPlace(a),t.xd=h.x-a.x,t.yd=h.y-a.y,r&&(r.set(t),r.invertThis(),r.isZero()&&(r.xd=o.x,r.yd=o.y))}export{O as $,Ht as A,Ni as B,Os as C,At as D,xt as E,he as F,se as G,Us as H,Et as I,Di as J,ge as K,ys as L,H as M,js as N,le as O,W as P,Tt as Q,Rt as R,Gi as S,j as T,fs as U,te as V,Li as W,Ai as X,ds as Y,Yi as Z,R as _,V as a,Wi as a$,Oi as a0,Ie as a1,is as a2,es as a3,at as a4,J as a5,Hs as a6,M as a7,Ui as a8,ae as a9,De as aA,Ct as aB,Ee as aC,Ji as aD,Vi as aE,qi as aF,xs as aG,ie as aH,gs as aI,Qi as aJ,Te as aK,zs as aL,Ls as aM,ts as aN,ue as aO,$s as aP,Hi as aQ,ks as aR,Gs as aS,ct as aT,_e as aU,Xi as aV,pi as aW,Xs as aX,Js as aY,pe as aZ,we as a_,Nt as aa,xi as ab,fi as ac,Mi as ad,Pt as ae,ki as af,ze as ag,Pe as ah,B as ai,as as aj,Zi as ak,cs as al,Qs as am,tt as an,ci as ao,_i as ap,gi as aq,$i as ar,yi as as,Ci as at,Ri as au,Se as av,Ze as aw,Ii as ax,Ei as ay,Si as az,Kt as b,Vs as b0,ve as b1,Ae as b2,Be as b3,Ge as b4,ke as b5,wi as b6,me as b7,re as b8,Ne as b9,Ms as ba,ji as c,bt as d,p as e,yt as f,Jt as g,Xt as h,Fs as i,Ys as j,Ki as k,Ss as l,It as m,ot as n,_ as o,Zs as p,ce as q,Bi as r,Ti as s,bi as t,vi as u,Bs as v,Dt as w,k as x,$t as y,Y as z};
