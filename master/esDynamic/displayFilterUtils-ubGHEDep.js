import{bm as m,bn as l,bo as N,bl as s,bp as S}from"./main-BC8gbEPx.js";function b(t,e){return{...e,filterMode:t.mode}}function x(t,e){return I(t,e).next().value??null}function T(t,e,n){const r=p(t);if(r&&(m(e,r[0])||l(n,r[1])))return"";const o=Array.from(I(t,e,n)),i=h(o,e,n)?"1=1":o.map(u=>u.where||"1=1").reduce((u,f)=>N(u,f),"");return i&&i!=="1=1"?i:""}function p(t){if(d(t)==="manual")return null;const e=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:n,maxScale:r}of t.filters)e[0]=Math.max(e[0],a(n)),e[1]=Math.min(e[1],c(r));return e}function*I(t,e,n){if(d(t)==="manual"){const r=t.filters.find(o=>o.id===t.activeFilterId);r&&(yield r)}else{typeof e=="object"&&(e=e.scale);for(const r of t.filters)y(r.minScale,r.maxScale,e,n)&&(yield r)}}function h(t,e,n){if(t.length===0)return!0;const r=a(t.at(0)?.minScale),o=c(t.at(-1)?.maxScale);if(l(r,e)||m(o,n))return!0;for(let i=0;i<t.length-1;i++){const u=t[i],f=t[i+1];if(l(a(f.minScale),c(u.maxScale)))return!0}return!1}function y(t,e,n,r){return t=a(t),n=a(n),e=c(e),!(!s(n,t)&&(r??n)>t)&&!S(e,n)&&(r===void 0||!s(r,t))}function d(t){return"mode"in t?t.mode:t.filterMode}function a(t){return t||Number.POSITIVE_INFINITY}function c(t){return t||0}export{T as c,b as i,x as u};
